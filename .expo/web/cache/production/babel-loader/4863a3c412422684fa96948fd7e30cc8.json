{"ast":null,"code":"var elliptic=require('elliptic');var BN=require('bn.js');module.exports=function createECDH(curve){return new ECDH(curve);};var aliases={secp256k1:{name:'secp256k1',byteLength:32},secp224r1:{name:'p224',byteLength:28},prime256v1:{name:'p256',byteLength:32},prime192v1:{name:'p192',byteLength:24},ed25519:{name:'ed25519',byteLength:32},secp384r1:{name:'p384',byteLength:48},secp521r1:{name:'p521',byteLength:66}};aliases.p224=aliases.secp224r1;aliases.p256=aliases.secp256r1=aliases.prime256v1;aliases.p192=aliases.secp192r1=aliases.prime192v1;aliases.p384=aliases.secp384r1;aliases.p521=aliases.secp521r1;function ECDH(curve){this.curveType=aliases[curve];if(!this.curveType){this.curveType={name:curve};}this.curve=new elliptic.ec(this.curveType.name);this.keys=void 0;}ECDH.prototype.generateKeys=function(enc,format){this.keys=this.curve.genKeyPair();return this.getPublicKey(enc,format);};ECDH.prototype.computeSecret=function(other,inenc,enc){inenc=inenc||'utf8';if(!Buffer.isBuffer(other)){other=new Buffer(other,inenc);}var otherPub=this.curve.keyFromPublic(other).getPublic();var out=otherPub.mul(this.keys.getPrivate()).getX();return formatReturnValue(out,enc,this.curveType.byteLength);};ECDH.prototype.getPublicKey=function(enc,format){var key=this.keys.getPublic(format==='compressed',true);if(format==='hybrid'){if(key[key.length-1]%2){key[0]=7;}else{key[0]=6;}}return formatReturnValue(key,enc);};ECDH.prototype.getPrivateKey=function(enc){return formatReturnValue(this.keys.getPrivate(),enc);};ECDH.prototype.setPublicKey=function(pub,enc){enc=enc||'utf8';if(!Buffer.isBuffer(pub)){pub=new Buffer(pub,enc);}this.keys._importPublic(pub);return this;};ECDH.prototype.setPrivateKey=function(priv,enc){enc=enc||'utf8';if(!Buffer.isBuffer(priv)){priv=new Buffer(priv,enc);}var _priv=new BN(priv);_priv=_priv.toString(16);this.keys=this.curve.genKeyPair();this.keys._importPrivate(_priv);return this;};function formatReturnValue(bn,enc,len){if(!Array.isArray(bn)){bn=bn.toArray();}var buf=new Buffer(bn);if(len&&buf.length<len){var zeros=new Buffer(len-buf.length);zeros.fill(0);buf=Buffer.concat([zeros,buf]);}if(!enc){return buf;}else{return buf.toString(enc);}}","map":{"version":3,"names":["elliptic","require","BN","module","exports","createECDH","curve","ECDH","aliases","secp256k1","name","byteLength","secp224r1","prime256v1","prime192v1","ed25519","secp384r1","secp521r1","p224","p256","secp256r1","p192","secp192r1","p384","p521","curveType","ec","keys","prototype","generateKeys","enc","format","genKeyPair","getPublicKey","computeSecret","other","inenc","Buffer","isBuffer","otherPub","keyFromPublic","getPublic","out","mul","getPrivate","getX","formatReturnValue","key","length","getPrivateKey","setPublicKey","pub","_importPublic","setPrivateKey","priv","_priv","toString","_importPrivate","bn","len","Array","isArray","toArray","buf","zeros","fill","concat"],"sources":["C:/Users/Nam-QTS/AppData/Roaming/nvm/v14.18.1/node_modules/expo-cli/node_modules/create-ecdh/browser.js"],"sourcesContent":["var elliptic = require('elliptic')\nvar BN = require('bn.js')\n\nmodule.exports = function createECDH (curve) {\n  return new ECDH(curve)\n}\n\nvar aliases = {\n  secp256k1: {\n    name: 'secp256k1',\n    byteLength: 32\n  },\n  secp224r1: {\n    name: 'p224',\n    byteLength: 28\n  },\n  prime256v1: {\n    name: 'p256',\n    byteLength: 32\n  },\n  prime192v1: {\n    name: 'p192',\n    byteLength: 24\n  },\n  ed25519: {\n    name: 'ed25519',\n    byteLength: 32\n  },\n  secp384r1: {\n    name: 'p384',\n    byteLength: 48\n  },\n  secp521r1: {\n    name: 'p521',\n    byteLength: 66\n  }\n}\n\naliases.p224 = aliases.secp224r1\naliases.p256 = aliases.secp256r1 = aliases.prime256v1\naliases.p192 = aliases.secp192r1 = aliases.prime192v1\naliases.p384 = aliases.secp384r1\naliases.p521 = aliases.secp521r1\n\nfunction ECDH (curve) {\n  this.curveType = aliases[curve]\n  if (!this.curveType) {\n    this.curveType = {\n      name: curve\n    }\n  }\n  this.curve = new elliptic.ec(this.curveType.name) // eslint-disable-line new-cap\n  this.keys = void 0\n}\n\nECDH.prototype.generateKeys = function (enc, format) {\n  this.keys = this.curve.genKeyPair()\n  return this.getPublicKey(enc, format)\n}\n\nECDH.prototype.computeSecret = function (other, inenc, enc) {\n  inenc = inenc || 'utf8'\n  if (!Buffer.isBuffer(other)) {\n    other = new Buffer(other, inenc)\n  }\n  var otherPub = this.curve.keyFromPublic(other).getPublic()\n  var out = otherPub.mul(this.keys.getPrivate()).getX()\n  return formatReturnValue(out, enc, this.curveType.byteLength)\n}\n\nECDH.prototype.getPublicKey = function (enc, format) {\n  var key = this.keys.getPublic(format === 'compressed', true)\n  if (format === 'hybrid') {\n    if (key[key.length - 1] % 2) {\n      key[0] = 7\n    } else {\n      key[0] = 6\n    }\n  }\n  return formatReturnValue(key, enc)\n}\n\nECDH.prototype.getPrivateKey = function (enc) {\n  return formatReturnValue(this.keys.getPrivate(), enc)\n}\n\nECDH.prototype.setPublicKey = function (pub, enc) {\n  enc = enc || 'utf8'\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc)\n  }\n  this.keys._importPublic(pub)\n  return this\n}\n\nECDH.prototype.setPrivateKey = function (priv, enc) {\n  enc = enc || 'utf8'\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc)\n  }\n\n  var _priv = new BN(priv)\n  _priv = _priv.toString(16)\n  this.keys = this.curve.genKeyPair()\n  this.keys._importPrivate(_priv)\n  return this\n}\n\nfunction formatReturnValue (bn, enc, len) {\n  if (!Array.isArray(bn)) {\n    bn = bn.toArray()\n  }\n  var buf = new Buffer(bn)\n  if (len && buf.length < len) {\n    var zeros = new Buffer(len - buf.length)\n    zeros.fill(0)\n    buf = Buffer.concat([zeros, buf])\n  }\n  if (!enc) {\n    return buf\n  } else {\n    return buf.toString(enc)\n  }\n}\n"],"mappings":"AAAA,GAAIA,SAAQ,CAAGC,OAAO,CAAC,UAAU,CAAC,CAClC,GAAIC,GAAE,CAAGD,OAAO,CAAC,OAAO,CAAC,CAEzBE,MAAM,CAACC,OAAO,CAAG,QAASC,WAAU,CAAEC,KAAK,CAAE,CAC3C,MAAO,IAAIC,KAAI,CAACD,KAAK,CAAC,CACxB,CAAC,CAED,GAAIE,QAAO,CAAG,CACZC,SAAS,CAAE,CACTC,IAAI,CAAE,WAAW,CACjBC,UAAU,CAAE,EACd,CAAC,CACDC,SAAS,CAAE,CACTF,IAAI,CAAE,MAAM,CACZC,UAAU,CAAE,EACd,CAAC,CACDE,UAAU,CAAE,CACVH,IAAI,CAAE,MAAM,CACZC,UAAU,CAAE,EACd,CAAC,CACDG,UAAU,CAAE,CACVJ,IAAI,CAAE,MAAM,CACZC,UAAU,CAAE,EACd,CAAC,CACDI,OAAO,CAAE,CACPL,IAAI,CAAE,SAAS,CACfC,UAAU,CAAE,EACd,CAAC,CACDK,SAAS,CAAE,CACTN,IAAI,CAAE,MAAM,CACZC,UAAU,CAAE,EACd,CAAC,CACDM,SAAS,CAAE,CACTP,IAAI,CAAE,MAAM,CACZC,UAAU,CAAE,EACd,CACF,CAAC,CAEDH,OAAO,CAACU,IAAI,CAAGV,OAAO,CAACI,SAAS,CAChCJ,OAAO,CAACW,IAAI,CAAGX,OAAO,CAACY,SAAS,CAAGZ,OAAO,CAACK,UAAU,CACrDL,OAAO,CAACa,IAAI,CAAGb,OAAO,CAACc,SAAS,CAAGd,OAAO,CAACM,UAAU,CACrDN,OAAO,CAACe,IAAI,CAAGf,OAAO,CAACQ,SAAS,CAChCR,OAAO,CAACgB,IAAI,CAAGhB,OAAO,CAACS,SAAS,CAEhC,QAASV,KAAI,CAAED,KAAK,CAAE,CACpB,IAAI,CAACmB,SAAS,CAAGjB,OAAO,CAACF,KAAK,CAAC,CAC/B,GAAI,CAAC,IAAI,CAACmB,SAAS,CAAE,CACnB,IAAI,CAACA,SAAS,CAAG,CACff,IAAI,CAAEJ,KACR,CAAC,CACH,CACA,IAAI,CAACA,KAAK,CAAG,GAAIN,SAAQ,CAAC0B,EAAE,CAAC,IAAI,CAACD,SAAS,CAACf,IAAI,CAAC,CACjD,IAAI,CAACiB,IAAI,CAAG,IAAK,EAAC,CACpB,CAEApB,IAAI,CAACqB,SAAS,CAACC,YAAY,CAAG,SAAUC,GAAG,CAAEC,MAAM,CAAE,CACnD,IAAI,CAACJ,IAAI,CAAG,IAAI,CAACrB,KAAK,CAAC0B,UAAU,EAAE,CACnC,MAAO,KAAI,CAACC,YAAY,CAACH,GAAG,CAAEC,MAAM,CAAC,CACvC,CAAC,CAEDxB,IAAI,CAACqB,SAAS,CAACM,aAAa,CAAG,SAAUC,KAAK,CAAEC,KAAK,CAAEN,GAAG,CAAE,CAC1DM,KAAK,CAAGA,KAAK,EAAI,MAAM,CACvB,GAAI,CAACC,MAAM,CAACC,QAAQ,CAACH,KAAK,CAAC,CAAE,CAC3BA,KAAK,CAAG,GAAIE,OAAM,CAACF,KAAK,CAAEC,KAAK,CAAC,CAClC,CACA,GAAIG,SAAQ,CAAG,IAAI,CAACjC,KAAK,CAACkC,aAAa,CAACL,KAAK,CAAC,CAACM,SAAS,EAAE,CAC1D,GAAIC,IAAG,CAAGH,QAAQ,CAACI,GAAG,CAAC,IAAI,CAAChB,IAAI,CAACiB,UAAU,EAAE,CAAC,CAACC,IAAI,EAAE,CACrD,MAAOC,kBAAiB,CAACJ,GAAG,CAAEZ,GAAG,CAAE,IAAI,CAACL,SAAS,CAACd,UAAU,CAAC,CAC/D,CAAC,CAEDJ,IAAI,CAACqB,SAAS,CAACK,YAAY,CAAG,SAAUH,GAAG,CAAEC,MAAM,CAAE,CACnD,GAAIgB,IAAG,CAAG,IAAI,CAACpB,IAAI,CAACc,SAAS,CAACV,MAAM,GAAK,YAAY,CAAE,IAAI,CAAC,CAC5D,GAAIA,MAAM,GAAK,QAAQ,CAAE,CACvB,GAAIgB,GAAG,CAACA,GAAG,CAACC,MAAM,CAAG,CAAC,CAAC,CAAG,CAAC,CAAE,CAC3BD,GAAG,CAAC,CAAC,CAAC,CAAG,CAAC,CACZ,CAAC,IAAM,CACLA,GAAG,CAAC,CAAC,CAAC,CAAG,CAAC,CACZ,CACF,CACA,MAAOD,kBAAiB,CAACC,GAAG,CAAEjB,GAAG,CAAC,CACpC,CAAC,CAEDvB,IAAI,CAACqB,SAAS,CAACqB,aAAa,CAAG,SAAUnB,GAAG,CAAE,CAC5C,MAAOgB,kBAAiB,CAAC,IAAI,CAACnB,IAAI,CAACiB,UAAU,EAAE,CAAEd,GAAG,CAAC,CACvD,CAAC,CAEDvB,IAAI,CAACqB,SAAS,CAACsB,YAAY,CAAG,SAAUC,GAAG,CAAErB,GAAG,CAAE,CAChDA,GAAG,CAAGA,GAAG,EAAI,MAAM,CACnB,GAAI,CAACO,MAAM,CAACC,QAAQ,CAACa,GAAG,CAAC,CAAE,CACzBA,GAAG,CAAG,GAAId,OAAM,CAACc,GAAG,CAAErB,GAAG,CAAC,CAC5B,CACA,IAAI,CAACH,IAAI,CAACyB,aAAa,CAACD,GAAG,CAAC,CAC5B,MAAO,KAAI,CACb,CAAC,CAED5C,IAAI,CAACqB,SAAS,CAACyB,aAAa,CAAG,SAAUC,IAAI,CAAExB,GAAG,CAAE,CAClDA,GAAG,CAAGA,GAAG,EAAI,MAAM,CACnB,GAAI,CAACO,MAAM,CAACC,QAAQ,CAACgB,IAAI,CAAC,CAAE,CAC1BA,IAAI,CAAG,GAAIjB,OAAM,CAACiB,IAAI,CAAExB,GAAG,CAAC,CAC9B,CAEA,GAAIyB,MAAK,CAAG,GAAIrD,GAAE,CAACoD,IAAI,CAAC,CACxBC,KAAK,CAAGA,KAAK,CAACC,QAAQ,CAAC,EAAE,CAAC,CAC1B,IAAI,CAAC7B,IAAI,CAAG,IAAI,CAACrB,KAAK,CAAC0B,UAAU,EAAE,CACnC,IAAI,CAACL,IAAI,CAAC8B,cAAc,CAACF,KAAK,CAAC,CAC/B,MAAO,KAAI,CACb,CAAC,CAED,QAAST,kBAAiB,CAAEY,EAAE,CAAE5B,GAAG,CAAE6B,GAAG,CAAE,CACxC,GAAI,CAACC,KAAK,CAACC,OAAO,CAACH,EAAE,CAAC,CAAE,CACtBA,EAAE,CAAGA,EAAE,CAACI,OAAO,EAAE,CACnB,CACA,GAAIC,IAAG,CAAG,GAAI1B,OAAM,CAACqB,EAAE,CAAC,CACxB,GAAIC,GAAG,EAAII,GAAG,CAACf,MAAM,CAAGW,GAAG,CAAE,CAC3B,GAAIK,MAAK,CAAG,GAAI3B,OAAM,CAACsB,GAAG,CAAGI,GAAG,CAACf,MAAM,CAAC,CACxCgB,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC,CACbF,GAAG,CAAG1B,MAAM,CAAC6B,MAAM,CAAC,CAACF,KAAK,CAAED,GAAG,CAAC,CAAC,CACnC,CACA,GAAI,CAACjC,GAAG,CAAE,CACR,MAAOiC,IAAG,CACZ,CAAC,IAAM,CACL,MAAOA,IAAG,CAACP,QAAQ,CAAC1B,GAAG,CAAC,CAC1B,CACF"},"metadata":{},"sourceType":"script"}