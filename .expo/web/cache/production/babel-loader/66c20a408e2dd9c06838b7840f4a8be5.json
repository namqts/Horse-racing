{"ast":null,"code":"var parseKeys=require('parse-asn1');var randomBytes=require('randombytes');var createHash=require('create-hash');var mgf=require(\"./mgf\");var xor=require(\"./xor\");var BN=require('bn.js');var withPublic=require(\"./withPublic\");var crt=require('browserify-rsa');var Buffer=require('safe-buffer').Buffer;module.exports=function publicEncrypt(publicKey,msg,reverse){var padding;if(publicKey.padding){padding=publicKey.padding;}else if(reverse){padding=1;}else{padding=4;}var key=parseKeys(publicKey);var paddedMsg;if(padding===4){paddedMsg=oaep(key,msg);}else if(padding===1){paddedMsg=pkcs1(key,msg,reverse);}else if(padding===3){paddedMsg=new BN(msg);if(paddedMsg.cmp(key.modulus)>=0){throw new Error('data too long for modulus');}}else{throw new Error('unknown padding');}if(reverse){return crt(paddedMsg,key);}else{return withPublic(paddedMsg,key);}};function oaep(key,msg){var k=key.modulus.byteLength();var mLen=msg.length;var iHash=createHash('sha1').update(Buffer.alloc(0)).digest();var hLen=iHash.length;var hLen2=2*hLen;if(mLen>k-hLen2-2){throw new Error('message too long');}var ps=Buffer.alloc(k-mLen-hLen2-2);var dblen=k-hLen-1;var seed=randomBytes(hLen);var maskedDb=xor(Buffer.concat([iHash,ps,Buffer.alloc(1,1),msg],dblen),mgf(seed,dblen));var maskedSeed=xor(seed,mgf(maskedDb,hLen));return new BN(Buffer.concat([Buffer.alloc(1),maskedSeed,maskedDb],k));}function pkcs1(key,msg,reverse){var mLen=msg.length;var k=key.modulus.byteLength();if(mLen>k-11){throw new Error('message too long');}var ps;if(reverse){ps=Buffer.alloc(k-mLen-3,0xff);}else{ps=nonZero(k-mLen-3);}return new BN(Buffer.concat([Buffer.from([0,reverse?1:2]),ps,Buffer.alloc(1),msg],k));}function nonZero(len){var out=Buffer.allocUnsafe(len);var i=0;var cache=randomBytes(len*2);var cur=0;var num;while(i<len){if(cur===cache.length){cache=randomBytes(len*2);cur=0;}num=cache[cur++];if(num){out[i++]=num;}}return out;}","map":{"version":3,"names":["parseKeys","require","randomBytes","createHash","mgf","xor","BN","withPublic","crt","Buffer","module","exports","publicEncrypt","publicKey","msg","reverse","padding","key","paddedMsg","oaep","pkcs1","cmp","modulus","Error","k","byteLength","mLen","length","iHash","update","alloc","digest","hLen","hLen2","ps","dblen","seed","maskedDb","concat","maskedSeed","nonZero","from","len","out","allocUnsafe","i","cache","cur","num"],"sources":["C:/Users/Nam-QTS/AppData/Roaming/nvm/v14.18.1/node_modules/expo-cli/node_modules/public-encrypt/publicEncrypt.js"],"sourcesContent":["var parseKeys = require('parse-asn1')\nvar randomBytes = require('randombytes')\nvar createHash = require('create-hash')\nvar mgf = require('./mgf')\nvar xor = require('./xor')\nvar BN = require('bn.js')\nvar withPublic = require('./withPublic')\nvar crt = require('browserify-rsa')\nvar Buffer = require('safe-buffer').Buffer\n\nmodule.exports = function publicEncrypt (publicKey, msg, reverse) {\n  var padding\n  if (publicKey.padding) {\n    padding = publicKey.padding\n  } else if (reverse) {\n    padding = 1\n  } else {\n    padding = 4\n  }\n  var key = parseKeys(publicKey)\n  var paddedMsg\n  if (padding === 4) {\n    paddedMsg = oaep(key, msg)\n  } else if (padding === 1) {\n    paddedMsg = pkcs1(key, msg, reverse)\n  } else if (padding === 3) {\n    paddedMsg = new BN(msg)\n    if (paddedMsg.cmp(key.modulus) >= 0) {\n      throw new Error('data too long for modulus')\n    }\n  } else {\n    throw new Error('unknown padding')\n  }\n  if (reverse) {\n    return crt(paddedMsg, key)\n  } else {\n    return withPublic(paddedMsg, key)\n  }\n}\n\nfunction oaep (key, msg) {\n  var k = key.modulus.byteLength()\n  var mLen = msg.length\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest()\n  var hLen = iHash.length\n  var hLen2 = 2 * hLen\n  if (mLen > k - hLen2 - 2) {\n    throw new Error('message too long')\n  }\n  var ps = Buffer.alloc(k - mLen - hLen2 - 2)\n  var dblen = k - hLen - 1\n  var seed = randomBytes(hLen)\n  var maskedDb = xor(Buffer.concat([iHash, ps, Buffer.alloc(1, 1), msg], dblen), mgf(seed, dblen))\n  var maskedSeed = xor(seed, mgf(maskedDb, hLen))\n  return new BN(Buffer.concat([Buffer.alloc(1), maskedSeed, maskedDb], k))\n}\nfunction pkcs1 (key, msg, reverse) {\n  var mLen = msg.length\n  var k = key.modulus.byteLength()\n  if (mLen > k - 11) {\n    throw new Error('message too long')\n  }\n  var ps\n  if (reverse) {\n    ps = Buffer.alloc(k - mLen - 3, 0xff)\n  } else {\n    ps = nonZero(k - mLen - 3)\n  }\n  return new BN(Buffer.concat([Buffer.from([0, reverse ? 1 : 2]), ps, Buffer.alloc(1), msg], k))\n}\nfunction nonZero (len) {\n  var out = Buffer.allocUnsafe(len)\n  var i = 0\n  var cache = randomBytes(len * 2)\n  var cur = 0\n  var num\n  while (i < len) {\n    if (cur === cache.length) {\n      cache = randomBytes(len * 2)\n      cur = 0\n    }\n    num = cache[cur++]\n    if (num) {\n      out[i++] = num\n    }\n  }\n  return out\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}