{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"nativeID\",\"isRequired\",\"isInvalid\",\"isDisabled\",\"isReadOnly\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React from'react';import{useId}from'@react-native-aria/utils';import omit from'lodash.omit';import{ariaAttr}from\"../../../utils\";import{ResponsiveQueryContext}from\"../../../utils/useResponsiveQuery/ResponsiveQueryProvider\";import{uniqueId}from'lodash';export var FormControlContext=React.createContext({});export function useFormControlProvider(props){var idProp=props.nativeID,isRequired=props.isRequired,isInvalid=props.isInvalid,isDisabled=props.isDisabled,isReadOnly=props.isReadOnly,htmlProps=_objectWithoutProperties(props,_excluded);var id=uniqueId();var responsiveQueryContext=React.useContext(ResponsiveQueryContext);var disableCSSMediaQueries=responsiveQueryContext.disableCSSMediaQueries;if(!disableCSSMediaQueries){id=useId();}var nativeID=idProp||\"field-\".concat(id);var labelId=\"\".concat(nativeID,\"-label\");var feedbackId=\"\".concat(nativeID,\"-feedback\");var helpTextId=\"\".concat(nativeID,\"-helptext\");var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),hasFeedbackText=_React$useState2[0],setHasFeedbackText=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),hasHelpText=_React$useState4[0],setHasHelpText=_React$useState4[1];var context={isRequired:!!isRequired,isInvalid:!!isInvalid,isReadOnly:!!isReadOnly,isDisabled:!!isDisabled,hasFeedbackText:hasFeedbackText,setHasFeedbackText:setHasFeedbackText,hasHelpText:hasHelpText,setHasHelpText:setHasHelpText,nativeID:nativeID,labelId:labelId,feedbackId:feedbackId,helpTextId:helpTextId,htmlProps:htmlProps};return context;}export function useFormControl(props){var field=useFormControlContext();var describedBy=[];if(field!==null&&field!==void 0&&field.hasFeedbackText)describedBy.push(field===null||field===void 0?void 0:field.feedbackId);if(field!==null&&field!==void 0&&field.hasHelpText)describedBy.push(field===null||field===void 0?void 0:field.helpTextId);var ariaDescribedBy=describedBy.join(' ');var cleanProps=omit(props,['isInvalid','isDisabled','isReadOnly','isRequired']);var nativeID=props===null||props===void 0?void 0:props.nativeID;if(!nativeID&&field!==null&&field!==void 0&&field.nativeID){nativeID=\"\".concat(field===null||field===void 0?void 0:field.nativeID,\"-input\");}return _objectSpread(_objectSpread({},cleanProps),{},{nativeID:nativeID,disabled:props.isDisabled||(field===null||field===void 0?void 0:field.isDisabled),readOnly:props.isReadOnly||(field===null||field===void 0?void 0:field.isReadOnly),required:props.isRequired||(field===null||field===void 0?void 0:field.isRequired),accessibilityInvalid:ariaAttr(props.isInvalid||(field===null||field===void 0?void 0:field.isInvalid)),accessibilityRequired:ariaAttr(props.isRequired||(field===null||field===void 0?void 0:field.isRequired)),accessibilityReadOnly:ariaAttr(props.isReadOnly||(field===null||field===void 0?void 0:field.isReadOnly)),accessibilityDescribedBy:ariaDescribedBy||undefined});}export var useFormControlContext=function useFormControlContext(){return React.useContext(FormControlContext);};","map":{"version":3,"sources":["useFormControl.tsx"],"names":["React","useId","omit","ariaAttr","ResponsiveQueryContext","uniqueId","FormControlContext","createContext","useFormControlProvider","props","nativeID","idProp","isRequired","isInvalid","isDisabled","isReadOnly","htmlProps","id","responsiveQueryContext","useContext","disableCSSMediaQueries","labelId","feedbackId","helpTextId","hasFeedbackText","setHasFeedbackText","useState","hasHelpText","setHasHelpText","context","useFormControl","field","useFormControlContext","describedBy","push","ariaDescribedBy","join","cleanProps","disabled","readOnly","required","accessibilityInvalid","accessibilityRequired","accessibilityReadOnly","accessibilityDescribedBy","undefined"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useId } from '@react-native-aria/utils';\nimport omit from 'lodash.omit';\nimport type { IFormControlProps } from './types';\nimport { ariaAttr } from '../../../utils';\nimport { ResponsiveQueryContext } from '../../../utils/useResponsiveQuery/ResponsiveQueryProvider';\nimport { uniqueId } from 'lodash';\n\nexport type IFormControlContext = Omit<\n  ReturnType<typeof useFormControlProvider>,\n  'htmlProps'\n>;\n\nexport const FormControlContext = React.createContext({});\n\nexport function useFormControlProvider(props: IFormControlProps) {\n  const {\n    nativeID: idProp,\n    isRequired,\n    isInvalid,\n    isDisabled,\n    isReadOnly,\n    ...htmlProps\n  } = props;\n\n  let id = uniqueId();\n  const responsiveQueryContext = React.useContext(ResponsiveQueryContext);\n  const disableCSSMediaQueries = responsiveQueryContext.disableCSSMediaQueries;\n\n  if (!disableCSSMediaQueries) {\n    // This if statement technically breaks the rules of hooks, but is safe\n    // because the condition never changes after mounting.\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    id = useId();\n  }\n\n  // const id = '';\n  // Generate all the required ids\n  const nativeID = idProp || `field-${id}`;\n\n  const labelId = `${nativeID}-label`;\n  const feedbackId = `${nativeID}-feedback`;\n  const helpTextId = `${nativeID}-helptext`;\n\n  /**\n   * Track whether the `FormErrorMessage` has been rendered.\n   * We use this to append its id the the `aria-describedby` of the `input`.\n   */\n  const [hasFeedbackText, setHasFeedbackText] = React.useState(false);\n\n  /**\n   * Track whether the `FormHelperText` has been rendered.\n   * We use this to append its id the the `aria-describedby` of the `input`.\n   */\n  const [hasHelpText, setHasHelpText] = React.useState(false);\n\n  const context = {\n    isRequired: !!isRequired,\n    isInvalid: !!isInvalid,\n    isReadOnly: !!isReadOnly,\n    isDisabled: !!isDisabled,\n    hasFeedbackText,\n    setHasFeedbackText,\n    hasHelpText,\n    setHasHelpText,\n    nativeID,\n    labelId,\n    feedbackId,\n    helpTextId,\n    htmlProps,\n  };\n\n  return context;\n}\n\n/**\n * React hook that provides the props that should be spread on to\n * input fields (`input`, `select`, `textarea`, etc.).\n *\n * It provides a convenient way to control a form fields, validation\n * and helper text.\n */\nexport function useFormControl(props: IFormControlProps) {\n  const field = useFormControlContext();\n  const describedBy: any[] = [];\n\n  // Error message must be described first in all scenarios.\n  if (field?.hasFeedbackText) describedBy.push(field?.feedbackId);\n  if (field?.hasHelpText) describedBy.push(field?.helpTextId);\n  const ariaDescribedBy = describedBy.join(' ');\n\n  const cleanProps = omit(props, [\n    'isInvalid',\n    'isDisabled',\n    'isReadOnly',\n    'isRequired',\n  ]);\n\n  let nativeID = props?.nativeID;\n\n  if (!nativeID && field?.nativeID) {\n    nativeID = `${field?.nativeID}-input`;\n  }\n\n  return {\n    ...cleanProps,\n    nativeID: nativeID,\n    disabled: props.isDisabled || field?.isDisabled,\n    readOnly: props.isReadOnly || field?.isReadOnly,\n    required: props.isRequired || field?.isRequired,\n    accessibilityInvalid: ariaAttr(props.isInvalid || field?.isInvalid),\n    accessibilityRequired: ariaAttr(props.isRequired || field?.isRequired),\n    accessibilityReadOnly: ariaAttr(props.isReadOnly || field?.isReadOnly),\n    accessibilityDescribedBy: ariaDescribedBy || undefined,\n  };\n}\n\nexport const useFormControlContext = () => {\n  return (React.useContext(\n    FormControlContext\n  ) as unknown) as IFormControlContext;\n};\n"]},"metadata":{},"sourceType":"module"}