{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _excluded=[\"children\",\"style\"],_excluded2=[\"height\",\"width\",\"arrowProps\",\"actualPlacement\",\"style\",\"borderColor\",\"backgroundColor\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React from'react';import{useOverlayPosition}from'@react-native-aria/overlays';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import{createContext}from\"../../../utils\";import Box from\"../../primitives/Box\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";var defaultArrowHeight=15;var defaultArrowWidth=15;var getDiagonalLength=function getDiagonalLength(height,width){return Math.pow(height*height+width*width,0.5);};var _createContext=createContext('PopperContext'),_createContext2=_slicedToArray(_createContext,2),PopperProvider=_createContext2[0],usePopperContext=_createContext2[1];var Popper=function Popper(props){return React.createElement(PopperProvider,props,props.children);};var PopperContent=React.forwardRef(function(_ref,ref){var children=_ref.children,style=_ref.style,rest=_objectWithoutProperties(_ref,_excluded);var _usePopperContext=usePopperContext('PopperContent'),triggerRef=_usePopperContext.triggerRef,shouldFlip=_usePopperContext.shouldFlip,crossOffset=_usePopperContext.crossOffset,offset=_usePopperContext.offset,placementProp=_usePopperContext.placement,onClose=_usePopperContext.onClose,shouldOverlapWithTrigger=_usePopperContext.shouldOverlapWithTrigger,setOverlayRef=_usePopperContext.setOverlayRef;var overlayRef=React.useRef(null);var _useOverlayPosition=useOverlayPosition({targetRef:triggerRef,overlayRef:overlayRef,shouldFlip:shouldFlip,crossOffset:crossOffset,isOpen:rest.isOpen,offset:offset,placement:placementProp,containerPadding:0,onClose:onClose,shouldOverlapWithTrigger:shouldOverlapWithTrigger}),overlayProps=_useOverlayPosition.overlayProps,rendered=_useOverlayPosition.rendered,arrowProps=_useOverlayPosition.arrowProps,placement=_useOverlayPosition.placement;var restElements=[];var arrowElement=null;React.useEffect(function(){setOverlayRef&&setOverlayRef(overlayRef);},[overlayRef,setOverlayRef]);React.Children.forEach(children,function(child){if(React.isValidElement(child)&&child.type.displayName==='PopperArrow'){arrowElement=React.cloneElement(child,{arrowProps:arrowProps,actualPlacement:placement});}else{restElements.push(child);}});var arrowHeight=0;var arrowWidth=0;if(arrowElement){arrowHeight=defaultArrowHeight;arrowWidth=defaultArrowWidth;if(arrowElement.props.height){arrowHeight=arrowElement.props.height;}if(arrowElement.props.width){arrowWidth=arrowElement.props.width;}}var containerStyle=React.useMemo(function(){return getContainerStyle({placement:placement,arrowHeight:arrowHeight,arrowWidth:arrowWidth});},[arrowHeight,arrowWidth,placement]);var overlayStyle=React.useMemo(function(){return StyleSheet.create({overlay:_objectSpread(_objectSpread({},overlayProps.style),{},{opacity:rendered?1:0,position:'absolute'})});},[rendered,overlayProps.style]);if(useHasResponsiveProps(rest)){return null;}return React.createElement(View,{ref:overlayRef,collapsable:false,style:overlayStyle.overlay},arrowElement,React.createElement(Box,_extends({style:StyleSheet.flatten([containerStyle,style])},rest,{ref:ref}),restElements));});var PopperArrow=React.forwardRef(function(_ref2,ref){var _ref2$height=_ref2.height,height=_ref2$height===void 0?defaultArrowHeight:_ref2$height,_ref2$width=_ref2.width,width=_ref2$width===void 0?defaultArrowWidth:_ref2$width,arrowProps=_ref2.arrowProps,actualPlacement=_ref2.actualPlacement,style=_ref2.style,_ref2$borderColor=_ref2.borderColor,borderColor=_ref2$borderColor===void 0?'#52525b':_ref2$borderColor,_ref2$backgroundColor=_ref2.backgroundColor,backgroundColor=_ref2$backgroundColor===void 0?'black':_ref2$backgroundColor,rest=_objectWithoutProperties(_ref2,_excluded2);var additionalStyles=React.useMemo(function(){return getArrowStyles({placement:actualPlacement,height:height,width:width});},[actualPlacement,height,width]);var triangleStyle=React.useMemo(function(){return{position:'absolute',width:width,height:height};},[width,height]);var arrowStyles=React.useMemo(function(){return[arrowProps.style,triangleStyle,additionalStyles,style];},[triangleStyle,additionalStyles,arrowProps.style,style]);return React.createElement(Box,_extends({ref:ref,style:arrowStyles,borderColor:borderColor,backgroundColor:backgroundColor,zIndex:1},rest));});var getArrowStyles=function getArrowStyles(props){var additionalStyles={transform:[]};var diagonalLength=getDiagonalLength(defaultArrowHeight,defaultArrowHeight);if(props.placement==='top'&&props.width){additionalStyles.transform.push({translateX:-props.width/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.bottom=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderBottomWidth=1;additionalStyles.borderRightWidth=1;}if(props.placement==='bottom'&&props.width){additionalStyles.transform.push({translateX:-props.width/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.top=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderTopWidth=1;additionalStyles.borderLeftWidth=1;}if(props.placement==='left'&&props.height){additionalStyles.transform.push({translateY:-props.height/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.right=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderTopWidth=1;additionalStyles.borderRightWidth=1;}if(props.placement==='right'&&props.height){additionalStyles.transform.push({translateY:-props.height/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.left=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderBottomWidth=1;additionalStyles.borderLeftWidth=1;}return additionalStyles;};var getContainerStyle=function getContainerStyle(_ref3){var placement=_ref3.placement,arrowHeight=_ref3.arrowHeight;var diagonalLength=getDiagonalLength(arrowHeight,arrowHeight)/2;if(placement==='top'){return{marginBottom:diagonalLength};}if(placement==='bottom'){return{marginTop:diagonalLength};}if(placement==='left'){return{marginRight:diagonalLength};}if(placement==='right'){return{marginLeft:diagonalLength};}return{};};PopperArrow.displayName='PopperArrow';Popper.Content=PopperContent;Popper.Arrow=PopperArrow;export{Popper};","map":{"version":3,"sources":["Popper.tsx"],"names":["React","useOverlayPosition","createContext","Box","useHasResponsiveProps","defaultArrowHeight","defaultArrowWidth","getDiagonalLength","height","width","Math","pow","PopperProvider","usePopperContext","Popper","props","children","PopperContent","forwardRef","style","rest","ref","triggerRef","shouldFlip","crossOffset","offset","placement","placementProp","onClose","shouldOverlapWithTrigger","setOverlayRef","overlayRef","useRef","overlayProps","rendered","arrowProps","targetRef","isOpen","containerPadding","restElements","arrowElement","useEffect","Children","forEach","child","isValidElement","type","displayName","cloneElement","actualPlacement","push","arrowHeight","arrowWidth","containerStyle","useMemo","getContainerStyle","overlayStyle","create","overlay","opacity","position","StyleSheet","flatten","PopperArrow","borderColor","backgroundColor","additionalStyles","getArrowStyles","triangleStyle","arrowStyles","transform","diagonalLength","translateX","rotate","bottom","ceil","borderBottomWidth","borderRightWidth","top","borderTopWidth","borderLeftWidth","translateY","right","left","marginBottom","marginTop","marginRight","marginLeft","Content","Arrow"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useOverlayPosition } from '@react-native-aria/overlays';\nimport { StyleSheet, View, ViewStyle } from 'react-native';\nimport type {\n  IPopperProps,\n  IScrollContentStyle,\n  IArrowStyles,\n  IPopoverArrowProps,\n} from './types';\nimport { createContext } from '../../../utils';\nimport Box, { IBoxProps } from '../../primitives/Box';\n// import { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst defaultArrowHeight = 15;\nconst defaultArrowWidth = 15;\n\nconst getDiagonalLength = (height: number, width: number) => {\n  return Math.pow(height * height + width * width, 0.5);\n};\n\ntype PopperContext = IPopperProps & {\n  triggerRef: any;\n  onClose: any;\n  setOverlayRef?: (overlayRef: any) => void;\n};\n\nconst [PopperProvider, usePopperContext] = createContext<PopperContext>(\n  'PopperContext'\n);\n\nconst Popper = (\n  props: IPopperProps & {\n    triggerRef: any;\n    onClose: any;\n    setOverlayRef?: (overlayRef: any) => void;\n  }\n) => {\n  return <PopperProvider {...props}>{props.children}</PopperProvider>;\n};\n\nconst PopperContent = React.forwardRef(\n  ({ children, style, ...rest }: IBoxProps & { isOpen: boolean }, ref: any) => {\n    const {\n      triggerRef,\n      shouldFlip,\n      crossOffset,\n      offset,\n      placement: placementProp,\n      onClose,\n      shouldOverlapWithTrigger,\n      setOverlayRef,\n    } = usePopperContext('PopperContent');\n    const overlayRef = React.useRef(null);\n\n    // const { top } = useSafeAreaInsets();\n    const {\n      overlayProps,\n      rendered,\n      arrowProps,\n      placement,\n    } = useOverlayPosition({\n      targetRef: triggerRef,\n      overlayRef,\n      shouldFlip: shouldFlip,\n      crossOffset: crossOffset,\n      isOpen: rest.isOpen,\n      offset: offset,\n      placement: placementProp as any,\n      containerPadding: 0,\n      onClose: onClose,\n      shouldOverlapWithTrigger,\n    });\n\n    const restElements: React.ReactNode[] = [];\n    let arrowElement: React.ReactElement | null = null;\n\n    React.useEffect(() => {\n      setOverlayRef && setOverlayRef(overlayRef);\n    }, [overlayRef, setOverlayRef]);\n\n    // Might have performance impact if there are a lot of siblings!\n    // Shouldn't be an issue with popovers since it would have atmost 2. Arrow and Content.\n    React.Children.forEach(children, (child) => {\n      if (\n        React.isValidElement(child) &&\n        // @ts-ignore\n        child.type.displayName === 'PopperArrow'\n      ) {\n        arrowElement = React.cloneElement(child, {\n          // @ts-ignore\n          arrowProps,\n          actualPlacement: placement,\n        });\n      } else {\n        restElements.push(child);\n      }\n    });\n\n    let arrowHeight = 0;\n    let arrowWidth = 0;\n\n    if (arrowElement) {\n      arrowHeight = defaultArrowHeight;\n      arrowWidth = defaultArrowWidth;\n\n      //@ts-ignore\n      if (arrowElement.props.height) {\n        //@ts-ignore\n        arrowHeight = arrowElement.props.height;\n      }\n\n      //@ts-ignore\n      if (arrowElement.props.width) {\n        //@ts-ignore\n        arrowWidth = arrowElement.props.width;\n      }\n    }\n\n    const containerStyle = React.useMemo(\n      () =>\n        getContainerStyle({\n          placement,\n          arrowHeight,\n          arrowWidth,\n        }),\n      [arrowHeight, arrowWidth, placement]\n    );\n\n    const overlayStyle = React.useMemo(\n      () =>\n        StyleSheet.create({\n          overlay: {\n            ...overlayProps.style,\n            // To handle translucent android StatusBar\n            // marginTop: Platform.select({ android: top, default: 0 }),\n            opacity: rendered ? 1 : 0,\n            position: 'absolute',\n          },\n        }),\n      [rendered, overlayProps.style]\n    );\n    //TODO: refactor for responsive prop\n    if (useHasResponsiveProps(rest)) {\n      return null;\n    }\n\n    return (\n      <View ref={overlayRef} collapsable={false} style={overlayStyle.overlay}>\n        {arrowElement}\n        <Box\n          style={StyleSheet.flatten([containerStyle, style])}\n          {...rest}\n          ref={ref}\n        >\n          {restElements}\n        </Box>\n      </View>\n    );\n  }\n);\n\n// This is an internal implementation of PopoverArrow\nconst PopperArrow = React.forwardRef(\n  (\n    {\n      height = defaultArrowHeight,\n      width = defaultArrowWidth,\n\n      //@ts-ignore - Will be passed by React.cloneElement from PopperContent\n      arrowProps,\n      //@ts-ignore - Will be passed by React.cloneElement from PopperContent\n      actualPlacement,\n      style,\n      borderColor = '#52525b',\n      backgroundColor = 'black',\n      ...rest\n    }: IPopoverArrowProps & IBoxProps<IPopoverArrowProps>,\n    ref: any\n  ) => {\n    const additionalStyles = React.useMemo(\n      () => getArrowStyles({ placement: actualPlacement, height, width }),\n      [actualPlacement, height, width]\n    );\n\n    const triangleStyle: ViewStyle = React.useMemo(\n      () => ({\n        position: 'absolute',\n        width,\n        height,\n      }),\n      [width, height]\n    );\n\n    const arrowStyles = React.useMemo(\n      () => [arrowProps.style, triangleStyle, additionalStyles, style],\n      [triangleStyle, additionalStyles, arrowProps.style, style]\n    );\n\n    return (\n      <Box\n        ref={ref}\n        style={arrowStyles}\n        borderColor={borderColor}\n        backgroundColor={backgroundColor}\n        zIndex={1}\n        {...rest}\n      />\n    );\n  }\n);\n\nconst getArrowStyles = (props: IArrowStyles) => {\n  const additionalStyles: any = {\n    transform: [],\n  };\n\n  const diagonalLength = getDiagonalLength(\n    defaultArrowHeight,\n    defaultArrowHeight\n  );\n\n  if (props.placement === 'top' && props.width) {\n    additionalStyles.transform.push({ translateX: -props.width / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.bottom = Math.ceil(\n      (diagonalLength - defaultArrowHeight) / 2\n    );\n    additionalStyles.borderBottomWidth = 1;\n    additionalStyles.borderRightWidth = 1;\n  }\n\n  if (props.placement === 'bottom' && props.width) {\n    additionalStyles.transform.push({ translateX: -props.width / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.top = Math.ceil((diagonalLength - defaultArrowHeight) / 2);\n    additionalStyles.borderTopWidth = 1;\n    additionalStyles.borderLeftWidth = 1;\n  }\n\n  if (props.placement === 'left' && props.height) {\n    additionalStyles.transform.push({ translateY: -props.height / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.right = Math.ceil(\n      (diagonalLength - defaultArrowHeight) / 2\n    );\n    additionalStyles.borderTopWidth = 1;\n    additionalStyles.borderRightWidth = 1;\n  }\n\n  if (props.placement === 'right' && props.height) {\n    additionalStyles.transform.push({ translateY: -props.height / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.left = Math.ceil(\n      (diagonalLength - defaultArrowHeight) / 2\n    );\n    additionalStyles.borderBottomWidth = 1;\n    additionalStyles.borderLeftWidth = 1;\n  }\n\n  return additionalStyles;\n};\n\nconst getContainerStyle = ({ placement, arrowHeight }: IScrollContentStyle) => {\n  const diagonalLength = getDiagonalLength(arrowHeight, arrowHeight) / 2;\n\n  if (placement === 'top') {\n    return { marginBottom: diagonalLength };\n  }\n\n  if (placement === 'bottom') {\n    return { marginTop: diagonalLength };\n  }\n\n  if (placement === 'left') {\n    return { marginRight: diagonalLength };\n  }\n\n  if (placement === 'right') {\n    return { marginLeft: diagonalLength };\n  }\n\n  return {};\n};\n\nPopperArrow.displayName = 'PopperArrow';\nPopper.Content = PopperContent;\nPopper.Arrow = PopperArrow;\n\nexport { Popper };\n"]},"metadata":{},"sourceType":"module"}