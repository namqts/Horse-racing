{"ast":null,"code":"var parseKeys=require('parse-asn1');var mgf=require(\"./mgf\");var xor=require(\"./xor\");var BN=require('bn.js');var crt=require('browserify-rsa');var createHash=require('create-hash');var withPublic=require(\"./withPublic\");var Buffer=require('safe-buffer').Buffer;module.exports=function privateDecrypt(privateKey,enc,reverse){var padding;if(privateKey.padding){padding=privateKey.padding;}else if(reverse){padding=1;}else{padding=4;}var key=parseKeys(privateKey);var k=key.modulus.byteLength();if(enc.length>k||new BN(enc).cmp(key.modulus)>=0){throw new Error('decryption error');}var msg;if(reverse){msg=withPublic(new BN(enc),key);}else{msg=crt(enc,key);}var zBuffer=Buffer.alloc(k-msg.length);msg=Buffer.concat([zBuffer,msg],k);if(padding===4){return oaep(key,msg);}else if(padding===1){return pkcs1(key,msg,reverse);}else if(padding===3){return msg;}else{throw new Error('unknown padding');}};function oaep(key,msg){var k=key.modulus.byteLength();var iHash=createHash('sha1').update(Buffer.alloc(0)).digest();var hLen=iHash.length;if(msg[0]!==0){throw new Error('decryption error');}var maskedSeed=msg.slice(1,hLen+1);var maskedDb=msg.slice(hLen+1);var seed=xor(maskedSeed,mgf(maskedDb,hLen));var db=xor(maskedDb,mgf(seed,k-hLen-1));if(compare(iHash,db.slice(0,hLen))){throw new Error('decryption error');}var i=hLen;while(db[i]===0){i++;}if(db[i++]!==1){throw new Error('decryption error');}return db.slice(i);}function pkcs1(key,msg,reverse){var p1=msg.slice(0,2);var i=2;var status=0;while(msg[i++]!==0){if(i>=msg.length){status++;break;}}var ps=msg.slice(2,i-1);if(p1.toString('hex')!=='0002'&&!reverse||p1.toString('hex')!=='0001'&&reverse){status++;}if(ps.length<8){status++;}if(status){throw new Error('decryption error');}return msg.slice(i);}function compare(a,b){a=Buffer.from(a);b=Buffer.from(b);var dif=0;var len=a.length;if(a.length!==b.length){dif++;len=Math.min(a.length,b.length);}var i=-1;while(++i<len){dif+=a[i]^b[i];}return dif;}","map":{"version":3,"names":["parseKeys","require","mgf","xor","BN","crt","createHash","withPublic","Buffer","module","exports","privateDecrypt","privateKey","enc","reverse","padding","key","k","modulus","byteLength","length","cmp","Error","msg","zBuffer","alloc","concat","oaep","pkcs1","iHash","update","digest","hLen","maskedSeed","slice","maskedDb","seed","db","compare","i","p1","status","ps","toString","a","b","from","dif","len","Math","min"],"sources":["C:/Users/Nam-QTS/AppData/Roaming/nvm/v14.18.1/node_modules/expo-cli/node_modules/public-encrypt/privateDecrypt.js"],"sourcesContent":["var parseKeys = require('parse-asn1')\nvar mgf = require('./mgf')\nvar xor = require('./xor')\nvar BN = require('bn.js')\nvar crt = require('browserify-rsa')\nvar createHash = require('create-hash')\nvar withPublic = require('./withPublic')\nvar Buffer = require('safe-buffer').Buffer\n\nmodule.exports = function privateDecrypt (privateKey, enc, reverse) {\n  var padding\n  if (privateKey.padding) {\n    padding = privateKey.padding\n  } else if (reverse) {\n    padding = 1\n  } else {\n    padding = 4\n  }\n\n  var key = parseKeys(privateKey)\n  var k = key.modulus.byteLength()\n  if (enc.length > k || new BN(enc).cmp(key.modulus) >= 0) {\n    throw new Error('decryption error')\n  }\n  var msg\n  if (reverse) {\n    msg = withPublic(new BN(enc), key)\n  } else {\n    msg = crt(enc, key)\n  }\n  var zBuffer = Buffer.alloc(k - msg.length)\n  msg = Buffer.concat([zBuffer, msg], k)\n  if (padding === 4) {\n    return oaep(key, msg)\n  } else if (padding === 1) {\n    return pkcs1(key, msg, reverse)\n  } else if (padding === 3) {\n    return msg\n  } else {\n    throw new Error('unknown padding')\n  }\n}\n\nfunction oaep (key, msg) {\n  var k = key.modulus.byteLength()\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest()\n  var hLen = iHash.length\n  if (msg[0] !== 0) {\n    throw new Error('decryption error')\n  }\n  var maskedSeed = msg.slice(1, hLen + 1)\n  var maskedDb = msg.slice(hLen + 1)\n  var seed = xor(maskedSeed, mgf(maskedDb, hLen))\n  var db = xor(maskedDb, mgf(seed, k - hLen - 1))\n  if (compare(iHash, db.slice(0, hLen))) {\n    throw new Error('decryption error')\n  }\n  var i = hLen\n  while (db[i] === 0) {\n    i++\n  }\n  if (db[i++] !== 1) {\n    throw new Error('decryption error')\n  }\n  return db.slice(i)\n}\n\nfunction pkcs1 (key, msg, reverse) {\n  var p1 = msg.slice(0, 2)\n  var i = 2\n  var status = 0\n  while (msg[i++] !== 0) {\n    if (i >= msg.length) {\n      status++\n      break\n    }\n  }\n  var ps = msg.slice(2, i - 1)\n\n  if ((p1.toString('hex') !== '0002' && !reverse) || (p1.toString('hex') !== '0001' && reverse)) {\n    status++\n  }\n  if (ps.length < 8) {\n    status++\n  }\n  if (status) {\n    throw new Error('decryption error')\n  }\n  return msg.slice(i)\n}\nfunction compare (a, b) {\n  a = Buffer.from(a)\n  b = Buffer.from(b)\n  var dif = 0\n  var len = a.length\n  if (a.length !== b.length) {\n    dif++\n    len = Math.min(a.length, b.length)\n  }\n  var i = -1\n  while (++i < len) {\n    dif += (a[i] ^ b[i])\n  }\n  return dif\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}