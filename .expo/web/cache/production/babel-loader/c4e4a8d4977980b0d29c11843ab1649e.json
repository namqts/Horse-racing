{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _excluded=[\"ratio\",\"children\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React,{forwardRef,memo}from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Platform from\"react-native-web/dist/exports/Platform\";import{default as Box}from\"../../primitives/Box\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";import{usePropsResolution}from\"../../../hooks\";var AspectView=forwardRef(function(props,ref){var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),layout=_React$useState2[0],setLayout=_React$useState2[1];var aspectViewStyle=[StyleSheet.flatten(props.style)||{}];if(layout){var _layout$width=layout.width,width=_layout$width===void 0?0:_layout$width,_layout$height=layout.height,height=_layout$height===void 0?0:_layout$height;if(width===0){aspectViewStyle.push({width:height*props.aspectRatio,height:height});}else{aspectViewStyle.push({width:width,height:width/props.aspectRatio});}}return React.createElement(Box,_extends({ref:ref},props,{style:aspectViewStyle,onLayout:function onLayout(_ref){var inLayout=_ref.nativeEvent.layout;return setLayout(inLayout);}}));});var AspectRatio=function AspectRatio(props,ref){var _children$props;var _usePropsResolution=usePropsResolution('AspectRatio',props,{},{resolveResponsively:['ratio']}),ratio=_usePropsResolution.ratio,_usePropsResolution$c=_usePropsResolution.children,children=_usePropsResolution$c===void 0?React.createElement(React.Fragment,null):_usePropsResolution$c,resolvedProps=_objectWithoutProperties(_usePropsResolution,_excluded);var computedStyle=resolvedProps.style;var newChildWithProps=React.cloneElement(children,_objectSpread(_objectSpread({},children===null||children===void 0?void 0:children.props),{},{style:StyleSheet.absoluteFillObject}),children===null||children===void 0?void 0:(_children$props=children.props)===null||_children$props===void 0?void 0:_children$props.children);if(useHasResponsiveProps(resolvedProps)){return null;}if(Platform.OS==='web'){return React.createElement(AspectView,_extends({aspectRatio:ratio},resolvedProps,{ref:ref}),newChildWithProps);}else{computedStyle=StyleSheet.flatten([{style:resolvedProps.style},{aspectRatio:ratio}]);return React.createElement(Box,_extends({},resolvedProps,{style:computedStyle,ref:ref}),newChildWithProps);}};export default memo(forwardRef(AspectRatio));","map":{"version":3,"sources":["index.tsx"],"names":["React","forwardRef","memo","default","Box","useHasResponsiveProps","usePropsResolution","AspectView","props","ref","layout","setLayout","useState","aspectViewStyle","StyleSheet","flatten","style","width","height","push","aspectRatio","nativeEvent","inLayout","AspectRatio","ratio","children","resolvedProps","resolveResponsively","computedStyle","newChildWithProps","cloneElement","absoluteFillObject","Platform","OS"],"mappings":"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","sourcesContent":["import React, { forwardRef, memo } from 'react';\nimport { StyleSheet, ViewStyle, Platform } from 'react-native';\nimport { default as Box } from '../../primitives/Box';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\nimport { usePropsResolution } from '../../../hooks';\nimport type { IAspectRatioProps } from './types';\n\nconst AspectView = forwardRef((props: any, ref?: any) => {\n  const [layout, setLayout] = React.useState();\n  const aspectViewStyle = [StyleSheet.flatten(props.style) || {}];\n  if (layout) {\n    // @ts-ignore\n    let { width = 0, height = 0 } = layout;\n    if (width === 0) {\n      aspectViewStyle.push({ width: height * props.aspectRatio, height });\n    } else {\n      aspectViewStyle.push({ width, height: width / props.aspectRatio });\n    }\n  }\n\n  return (\n    <Box\n      ref={ref}\n      {...props}\n      style={aspectViewStyle}\n      onLayout={({ nativeEvent: { layout: inLayout } }: any) =>\n        setLayout(inLayout)\n      }\n    />\n  );\n});\n\nconst AspectRatio = (props: IAspectRatioProps, ref?: any) => {\n  const { ratio, children = <></>, ...resolvedProps } = usePropsResolution(\n    'AspectRatio',\n    props,\n    {},\n    { resolveResponsively: ['ratio'] }\n  );\n  let computedStyle: ViewStyle | undefined = resolvedProps.style;\n  const newChildWithProps = React.cloneElement(\n    children,\n    {\n      ...children?.props,\n      style: StyleSheet.absoluteFillObject,\n    },\n    children?.props?.children\n  );\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(resolvedProps)) {\n    return null;\n  }\n  // DOC:  It uses a aspectRatio property of React Native and manually calculate on Web\n  if (Platform.OS === 'web') {\n    return (\n      <AspectView aspectRatio={ratio} {...resolvedProps} ref={ref}>\n        {newChildWithProps}\n      </AspectView>\n    );\n  } else {\n    computedStyle = StyleSheet.flatten([\n      { style: resolvedProps.style },\n      { aspectRatio: ratio },\n    ]);\n    return (\n      <Box {...resolvedProps} style={computedStyle} ref={ref}>\n        {newChildWithProps}\n      </Box>\n    );\n  }\n};\n\nexport default memo(forwardRef(AspectRatio));\n"]},"metadata":{},"sourceType":"module"}