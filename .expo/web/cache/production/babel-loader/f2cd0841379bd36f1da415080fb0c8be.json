{"ast":null,"code":"import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";var _excluded=[\"ref\"],_excluded2=[\"children\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import _regeneratorRuntime from\"@babel/runtime/regenerator\";function _createForOfIteratorHelperLoose(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}import $6nfFC$react,{useRef as $6nfFC$useRef,useContext as $6nfFC$useContext,useMemo as $6nfFC$useMemo,useEffect as $6nfFC$useEffect,useState as $6nfFC$useState,useCallback as $6nfFC$useCallback}from\"react\";import{useLayoutEffect as $6nfFC$useLayoutEffect,runAfterTransition as $6nfFC$runAfterTransition,focusWithoutScrolling as $6nfFC$focusWithoutScrolling,mergeProps as $6nfFC$mergeProps,useSyncRef as $6nfFC$useSyncRef}from\"@react-aria/utils\";import{getInteractionModality as $6nfFC$getInteractionModality,isFocusVisible as $6nfFC$isFocusVisible,useFocusVisibleListener as $6nfFC$useFocusVisibleListener,useFocus as $6nfFC$useFocus,useFocusWithin as $6nfFC$useFocusWithin,useKeyboard as $6nfFC$useKeyboard}from\"@react-aria/interactions\";import $6nfFC$clsx from\"clsx\";function $6a99195332edec8b$export$80f3e147d781571c(element){if($6nfFC$getInteractionModality()==='virtual'){var lastFocusedElement=document.activeElement;$6nfFC$runAfterTransition(function(){if(document.activeElement===lastFocusedElement&&document.contains(element))$6nfFC$focusWithoutScrolling(element);});}else $6nfFC$focusWithoutScrolling(element);}function $645f2e67b85a24c9$var$isStyleVisible(element){if(!(element instanceof HTMLElement)&&!(element instanceof SVGElement))return false;var _element$style=element.style,display=_element$style.display,visibility=_element$style.visibility;var isVisible=display!=='none'&&visibility!=='hidden'&&visibility!=='collapse';if(isVisible){var getComputedStyle=element.ownerDocument.defaultView.getComputedStyle;var _getComputedStyle=getComputedStyle(element),computedDisplay=_getComputedStyle.display,computedVisibility=_getComputedStyle.visibility;isVisible=computedDisplay!=='none'&&computedVisibility!=='hidden'&&computedVisibility!=='collapse';}return isVisible;}function $645f2e67b85a24c9$var$isAttributeVisible(element,childElement){return!element.hasAttribute('hidden')&&(element.nodeName==='DETAILS'&&childElement&&childElement.nodeName!=='SUMMARY'?element.hasAttribute('open'):true);}function $645f2e67b85a24c9$export$e989c0fffaa6b27a(element,childElement){return element.nodeName!=='#comment'&&$645f2e67b85a24c9$var$isStyleVisible(element)&&$645f2e67b85a24c9$var$isAttributeVisible(element,childElement)&&(!element.parentElement||$645f2e67b85a24c9$export$e989c0fffaa6b27a(element.parentElement,element));}var $9bf71ea28793e738$var$FocusContext=$6nfFC$react.createContext(null);var $9bf71ea28793e738$var$activeScope=null;function $9bf71ea28793e738$export$20e40289641fbbb6(props){var children=props.children,contain=props.contain,restoreFocus=props.restoreFocus,autoFocus=props.autoFocus;var startRef=$6nfFC$useRef();var endRef=$6nfFC$useRef();var scopeRef=$6nfFC$useRef([]);var ctx=$6nfFC$useContext($9bf71ea28793e738$var$FocusContext);var ref;var ctxParent=(ref=ctx===null||ctx===void 0?void 0:ctx.scopeRef)!==null&&ref!==void 0?ref:null;var parentScope1=$6nfFC$useMemo(function(){return $9bf71ea28793e738$var$activeScope&&$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode($9bf71ea28793e738$var$activeScope)&&!$9bf71ea28793e738$var$isAncestorScope($9bf71ea28793e738$var$activeScope,ctxParent)?$9bf71ea28793e738$var$activeScope:ctxParent;},[ctxParent]);$6nfFC$useLayoutEffect(function(){var node=startRef.current.nextSibling;var nodes=[];while(node&&node!==endRef.current){nodes.push(node);node=node.nextSibling;}scopeRef.current=nodes;},[children,parentScope1]);if($9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(parentScope1)&&!$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef))$9bf71ea28793e738$export$d06fae2ee68b101e.addTreeNode(scopeRef,parentScope1);var node1=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef);node1.contain=contain;$9bf71ea28793e738$var$useActiveScopeTracker(scopeRef,restoreFocus,contain);$9bf71ea28793e738$var$useFocusContainment(scopeRef,contain);$9bf71ea28793e738$var$useRestoreFocus(scopeRef,restoreFocus,contain);$9bf71ea28793e738$var$useAutoFocus(scopeRef,autoFocus);$6nfFC$useLayoutEffect(function(){if(scopeRef)return function(){var parentScope=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef).parent.scopeRef;if((scopeRef===$9bf71ea28793e738$var$activeScope||$9bf71ea28793e738$var$isAncestorScope(scopeRef,$9bf71ea28793e738$var$activeScope))&&(!parentScope||$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(parentScope)))$9bf71ea28793e738$var$activeScope=parentScope;$9bf71ea28793e738$export$d06fae2ee68b101e.removeTreeNode(scopeRef);};},[scopeRef,parentScope1]);var focusManager=$9bf71ea28793e738$var$createFocusManagerForScope(scopeRef);return $6nfFC$react.createElement($9bf71ea28793e738$var$FocusContext.Provider,{value:{scopeRef:scopeRef,focusManager:focusManager}},$6nfFC$react.createElement(\"span\",{\"data-focus-scope-start\":true,hidden:true,ref:startRef}),children,$6nfFC$react.createElement(\"span\",{\"data-focus-scope-end\":true,hidden:true,ref:endRef}));}function $9bf71ea28793e738$export$10c5169755ce7bd7(){var ref;return(ref=$6nfFC$useContext($9bf71ea28793e738$var$FocusContext))===null||ref===void 0?void 0:ref.focusManager;}function $9bf71ea28793e738$var$createFocusManagerForScope(scopeRef){return{focusNext:function focusNext(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var scope=scopeRef.current;var from=opts.from,tabbable=opts.tabbable,wrap=opts.wrap,accept=opts.accept;var node=from||document.activeElement;var sentinel=scope[0].previousElementSibling;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:tabbable,accept:accept},scope);walker.currentNode=$9bf71ea28793e738$var$isElementInScope(node,scope)?node:sentinel;var nextNode=walker.nextNode();if(!nextNode&&wrap){walker.currentNode=sentinel;nextNode=walker.nextNode();}if(nextNode)$9bf71ea28793e738$var$focusElement(nextNode,true);return nextNode;},focusPrevious:function focusPrevious(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var scope=scopeRef.current;var from=opts.from,tabbable=opts.tabbable,wrap=opts.wrap,accept=opts.accept;var node=from||document.activeElement;var sentinel=scope[scope.length-1].nextElementSibling;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:tabbable,accept:accept},scope);walker.currentNode=$9bf71ea28793e738$var$isElementInScope(node,scope)?node:sentinel;var previousNode=walker.previousNode();if(!previousNode&&wrap){walker.currentNode=sentinel;previousNode=walker.previousNode();}if(previousNode)$9bf71ea28793e738$var$focusElement(previousNode,true);return previousNode;},focusFirst:function focusFirst(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var scope=scopeRef.current;var tabbable=opts.tabbable,accept=opts.accept;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:tabbable,accept:accept},scope);walker.currentNode=scope[0].previousElementSibling;var nextNode=walker.nextNode();if(nextNode)$9bf71ea28793e738$var$focusElement(nextNode,true);return nextNode;},focusLast:function focusLast(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var scope=scopeRef.current;var tabbable=opts.tabbable,accept=opts.accept;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:tabbable,accept:accept},scope);walker.currentNode=scope[scope.length-1].nextElementSibling;var previousNode=walker.previousNode();if(previousNode)$9bf71ea28793e738$var$focusElement(previousNode,true);return previousNode;}};}var $9bf71ea28793e738$var$focusableElements=['input:not([disabled]):not([type=hidden])','select:not([disabled])','textarea:not([disabled])','button:not([disabled])','a[href]','area[href]','summary','iframe','object','embed','audio[controls]','video[controls]','[contenteditable]'];var $9bf71ea28793e738$var$FOCUSABLE_ELEMENT_SELECTOR=$9bf71ea28793e738$var$focusableElements.join(':not([hidden]),')+',[tabindex]:not([disabled]):not([hidden])';$9bf71ea28793e738$var$focusableElements.push('[tabindex]:not([tabindex=\"-1\"]):not([disabled])');var $9bf71ea28793e738$var$TABBABLE_ELEMENT_SELECTOR=$9bf71ea28793e738$var$focusableElements.join(':not([hidden]):not([tabindex=\"-1\"]),');function $9bf71ea28793e738$var$getScopeRoot(scope){return scope[0].parentElement;}function $9bf71ea28793e738$var$shouldContainFocus(scopeRef){var scope=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode($9bf71ea28793e738$var$activeScope);while(scope&&scope.scopeRef!==scopeRef){if(scope.contain)return false;scope=scope.parent;}return true;}function $9bf71ea28793e738$var$useFocusContainment(scopeRef,contain){var focusedNode=$6nfFC$useRef();var raf=$6nfFC$useRef(null);$6nfFC$useLayoutEffect(function(){var scope1=scopeRef.current;if(!contain){if(raf.current){cancelAnimationFrame(raf.current);raf.current=null;}return;}var onKeyDown=function onKeyDown(e){if(e.key!=='Tab'||e.altKey||e.ctrlKey||e.metaKey||!$9bf71ea28793e738$var$shouldContainFocus(scopeRef))return;var focusedElement=document.activeElement;var scope=scopeRef.current;if(!$9bf71ea28793e738$var$isElementInScope(focusedElement,scope))return;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:true},scope);walker.currentNode=focusedElement;var nextElement=e.shiftKey?walker.previousNode():walker.nextNode();if(!nextElement){walker.currentNode=e.shiftKey?scope[scope.length-1].nextElementSibling:scope[0].previousElementSibling;nextElement=e.shiftKey?walker.previousNode():walker.nextNode();}e.preventDefault();if(nextElement)$9bf71ea28793e738$var$focusElement(nextElement,true);};var onFocus=function onFocus(e){if((!$9bf71ea28793e738$var$activeScope||$9bf71ea28793e738$var$isAncestorScope($9bf71ea28793e738$var$activeScope,scopeRef))&&$9bf71ea28793e738$var$isElementInScope(e.target,scopeRef.current)){$9bf71ea28793e738$var$activeScope=scopeRef;focusedNode.current=e.target;}else if($9bf71ea28793e738$var$shouldContainFocus(scopeRef)&&!$9bf71ea28793e738$var$isElementInChildScope(e.target,scopeRef)){if(focusedNode.current)focusedNode.current.focus();else if($9bf71ea28793e738$var$activeScope)$9bf71ea28793e738$var$focusFirstInScope($9bf71ea28793e738$var$activeScope.current);}else if($9bf71ea28793e738$var$shouldContainFocus(scopeRef))focusedNode.current=e.target;};var onBlur=function onBlur(e){raf.current=requestAnimationFrame(function(){if($9bf71ea28793e738$var$shouldContainFocus(scopeRef)&&!$9bf71ea28793e738$var$isElementInChildScope(document.activeElement,scopeRef)){$9bf71ea28793e738$var$activeScope=scopeRef;if(document.body.contains(e.target)){focusedNode.current=e.target;focusedNode.current.focus();}else if($9bf71ea28793e738$var$activeScope)$9bf71ea28793e738$var$focusFirstInScope($9bf71ea28793e738$var$activeScope.current);}});};document.addEventListener('keydown',onKeyDown,false);document.addEventListener('focusin',onFocus,false);scope1.forEach(function(element){return element.addEventListener('focusin',onFocus,false);});scope1.forEach(function(element){return element.addEventListener('focusout',onBlur,false);});return function(){document.removeEventListener('keydown',onKeyDown,false);document.removeEventListener('focusin',onFocus,false);scope1.forEach(function(element){return element.removeEventListener('focusin',onFocus,false);});scope1.forEach(function(element){return element.removeEventListener('focusout',onBlur,false);});};},[scopeRef,contain]);$6nfFC$useEffect(function(){return function(){if(raf.current)cancelAnimationFrame(raf.current);};},[raf]);}function $9bf71ea28793e738$var$isElementInAnyScope(element){return $9bf71ea28793e738$var$isElementInChildScope(element);}function $9bf71ea28793e738$var$isElementInScope(element,scope){return scope.some(function(node){return node.contains(element);});}function $9bf71ea28793e738$var$isElementInChildScope(element){var scope=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;for(var _iterator=_createForOfIteratorHelperLoose($9bf71ea28793e738$export$d06fae2ee68b101e.traverse($9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scope))),_step;!(_step=_iterator()).done;){var _ref=_step.value;var s=_ref.scopeRef;if($9bf71ea28793e738$var$isElementInScope(element,s.current))return true;}return false;}function $9bf71ea28793e738$var$isAncestorScope(ancestor,scope){var ref;var parent=(ref=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scope))===null||ref===void 0?void 0:ref.parent;while(parent){if(parent.scopeRef===ancestor)return true;parent=parent.parent;}return false;}function $9bf71ea28793e738$var$focusElement(element){var scroll=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(element!=null&&!scroll)try{$6a99195332edec8b$export$80f3e147d781571c(element);}catch(err){}else if(element!=null)try{element.focus();}catch(err1){}}function $9bf71ea28793e738$var$focusFirstInScope(scope){var tabbable=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var sentinel=scope[0].previousElementSibling;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:tabbable},scope);walker.currentNode=sentinel;var nextNode=walker.nextNode();if(tabbable&&!nextNode){walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa($9bf71ea28793e738$var$getScopeRoot(scope),{tabbable:false},scope);walker.currentNode=sentinel;nextNode=walker.nextNode();}$9bf71ea28793e738$var$focusElement(nextNode);}function $9bf71ea28793e738$var$useAutoFocus(scopeRef,autoFocus){var autoFocusRef=$6nfFC$react.useRef(autoFocus);$6nfFC$useEffect(function(){if(autoFocusRef.current){$9bf71ea28793e738$var$activeScope=scopeRef;if(!$9bf71ea28793e738$var$isElementInScope(document.activeElement,$9bf71ea28793e738$var$activeScope.current))$9bf71ea28793e738$var$focusFirstInScope(scopeRef.current);}autoFocusRef.current=false;},[scopeRef]);}function $9bf71ea28793e738$var$useActiveScopeTracker(scopeRef,restore,contain){$6nfFC$useLayoutEffect(function(){if(restore||contain)return;var scope=scopeRef.current;var onFocus=function onFocus(e){var target=e.target;if($9bf71ea28793e738$var$isElementInScope(target,scopeRef.current))$9bf71ea28793e738$var$activeScope=scopeRef;else if(!$9bf71ea28793e738$var$isElementInAnyScope(target))$9bf71ea28793e738$var$activeScope=null;};document.addEventListener('focusin',onFocus,false);scope.forEach(function(element){return element.addEventListener('focusin',onFocus,false);});return function(){document.removeEventListener('focusin',onFocus,false);scope.forEach(function(element){return element.removeEventListener('focusin',onFocus,false);});};},[scopeRef,restore,contain]);}function $9bf71ea28793e738$var$shouldRestoreFocus(scopeRef){var scope=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode($9bf71ea28793e738$var$activeScope);while(scope&&scope.scopeRef!==scopeRef){if(scope.nodeToRestore)return false;scope=scope.parent;}return true;}function $9bf71ea28793e738$var$useRestoreFocus(scopeRef,restoreFocus,contain){var nodeToRestoreRef=$6nfFC$useRef(typeof document!=='undefined'?document.activeElement:null);$6nfFC$useLayoutEffect(function(){var scope=scopeRef.current;if(!restoreFocus||contain)return;var onFocus=function onFocus(){if(!$9bf71ea28793e738$var$activeScope||$9bf71ea28793e738$var$isAncestorScope($9bf71ea28793e738$var$activeScope,scopeRef))$9bf71ea28793e738$var$activeScope=scopeRef;};document.addEventListener('focusin',onFocus,false);scope.forEach(function(element){return element.addEventListener('focusin',onFocus,false);});return function(){document.removeEventListener('focusin',onFocus,false);scope.forEach(function(element){return element.removeEventListener('focusin',onFocus,false);});};},[scopeRef,contain]);$6nfFC$useLayoutEffect(function(){if(!restoreFocus)return;$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef).nodeToRestore=nodeToRestoreRef.current;var onKeyDown=function onKeyDown(e){if(e.key!=='Tab'||e.altKey||e.ctrlKey||e.metaKey)return;var focusedElement=document.activeElement;if(!$9bf71ea28793e738$var$isElementInScope(focusedElement,scopeRef.current))return;var nodeToRestore=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef).nodeToRestore;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa(document.body,{tabbable:true});walker.currentNode=focusedElement;var nextElement=e.shiftKey?walker.previousNode():walker.nextNode();if(!document.body.contains(nodeToRestore)||nodeToRestore===document.body){nodeToRestore=null;$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef).nodeToRestore=null;}if((!nextElement||!$9bf71ea28793e738$var$isElementInScope(nextElement,scopeRef.current))&&nodeToRestore){walker.currentNode=nodeToRestore;do{nextElement=e.shiftKey?walker.previousNode():walker.nextNode();}while($9bf71ea28793e738$var$isElementInScope(nextElement,scopeRef.current));e.preventDefault();e.stopPropagation();if(nextElement)$9bf71ea28793e738$var$focusElement(nextElement,true);else if(!$9bf71ea28793e738$var$isElementInAnyScope(nodeToRestore))focusedElement.blur();else $9bf71ea28793e738$var$focusElement(nodeToRestore,true);}};if(!contain)document.addEventListener('keydown',onKeyDown,true);return function(){if(!contain)document.removeEventListener('keydown',onKeyDown,true);var nodeToRestore=$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(scopeRef).nodeToRestore;if(restoreFocus&&nodeToRestore&&($9bf71ea28793e738$var$isElementInScope(document.activeElement,scopeRef.current)||document.activeElement===document.body&&$9bf71ea28793e738$var$shouldRestoreFocus(scopeRef))){var clonedTree=$9bf71ea28793e738$export$d06fae2ee68b101e.clone();requestAnimationFrame(function(){if(document.activeElement===document.body){var treeNode=clonedTree.getTreeNode(scopeRef);while(treeNode){if(treeNode.nodeToRestore&&document.body.contains(treeNode.nodeToRestore)){$9bf71ea28793e738$var$focusElement(treeNode.nodeToRestore);return;}treeNode=treeNode.parent;}treeNode=clonedTree.getTreeNode(scopeRef);while(treeNode){if(treeNode.scopeRef&&$9bf71ea28793e738$export$d06fae2ee68b101e.getTreeNode(treeNode.scopeRef)){$9bf71ea28793e738$var$focusFirstInScope(treeNode.scopeRef.current,true);return;}treeNode=treeNode.parent;}}});}};},[scopeRef,restoreFocus,contain]);}function $9bf71ea28793e738$export$2d6ec8fc375ceafa(root,opts,scope){var selector=(opts===null||opts===void 0?void 0:opts.tabbable)?$9bf71ea28793e738$var$TABBABLE_ELEMENT_SELECTOR:$9bf71ea28793e738$var$FOCUSABLE_ELEMENT_SELECTOR;var walker=document.createTreeWalker(root,NodeFilter.SHOW_ELEMENT,{acceptNode:function acceptNode(node){var ref;if(opts===null||opts===void 0?void 0:(ref=opts.from)===null||ref===void 0?void 0:ref.contains(node))return NodeFilter.FILTER_REJECT;if(node.matches(selector)&&$645f2e67b85a24c9$export$e989c0fffaa6b27a(node)&&(!scope||$9bf71ea28793e738$var$isElementInScope(node,scope))&&(!(opts===null||opts===void 0?void 0:opts.accept)||opts.accept(node)))return NodeFilter.FILTER_ACCEPT;return NodeFilter.FILTER_SKIP;}});if(opts===null||opts===void 0?void 0:opts.from)walker.currentNode=opts.from;return walker;}function $9bf71ea28793e738$export$c5251b9e124bf29(ref){var defaultOptions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return{focusNext:function focusNext(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var root=ref.current;if(!root)return;var from=opts.from,_opts$tabbable=opts.tabbable,tabbable=_opts$tabbable===void 0?defaultOptions.tabbable:_opts$tabbable,_opts$wrap=opts.wrap,wrap=_opts$wrap===void 0?defaultOptions.wrap:_opts$wrap,_opts$accept=opts.accept,accept=_opts$accept===void 0?defaultOptions.accept:_opts$accept;var node=from||document.activeElement;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa(root,{tabbable:tabbable,accept:accept});if(root.contains(node))walker.currentNode=node;var nextNode=walker.nextNode();if(!nextNode&&wrap){walker.currentNode=root;nextNode=walker.nextNode();}if(nextNode)$9bf71ea28793e738$var$focusElement(nextNode,true);return nextNode;},focusPrevious:function focusPrevious(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:defaultOptions;var root=ref.current;if(!root)return;var from=opts.from,_opts$tabbable2=opts.tabbable,tabbable=_opts$tabbable2===void 0?defaultOptions.tabbable:_opts$tabbable2,_opts$wrap2=opts.wrap,wrap=_opts$wrap2===void 0?defaultOptions.wrap:_opts$wrap2,_opts$accept2=opts.accept,accept=_opts$accept2===void 0?defaultOptions.accept:_opts$accept2;var node=from||document.activeElement;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa(root,{tabbable:tabbable,accept:accept});if(root.contains(node))walker.currentNode=node;else{var next=$9bf71ea28793e738$var$last(walker);if(next)$9bf71ea28793e738$var$focusElement(next,true);return next;}var previousNode=walker.previousNode();if(!previousNode&&wrap){walker.currentNode=root;previousNode=$9bf71ea28793e738$var$last(walker);}if(previousNode)$9bf71ea28793e738$var$focusElement(previousNode,true);return previousNode;},focusFirst:function focusFirst(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:defaultOptions;var root=ref.current;if(!root)return;var _opts$tabbable3=opts.tabbable,tabbable=_opts$tabbable3===void 0?defaultOptions.tabbable:_opts$tabbable3,_opts$accept3=opts.accept,accept=_opts$accept3===void 0?defaultOptions.accept:_opts$accept3;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa(root,{tabbable:tabbable,accept:accept});var nextNode=walker.nextNode();if(nextNode)$9bf71ea28793e738$var$focusElement(nextNode,true);return nextNode;},focusLast:function focusLast(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:defaultOptions;var root=ref.current;if(!root)return;var _opts$tabbable4=opts.tabbable,tabbable=_opts$tabbable4===void 0?defaultOptions.tabbable:_opts$tabbable4,_opts$accept4=opts.accept,accept=_opts$accept4===void 0?defaultOptions.accept:_opts$accept4;var walker=$9bf71ea28793e738$export$2d6ec8fc375ceafa(root,{tabbable:tabbable,accept:accept});var next=$9bf71ea28793e738$var$last(walker);if(next)$9bf71ea28793e738$var$focusElement(next,true);return next;}};}function $9bf71ea28793e738$var$last(walker){var next;var last;do{last=walker.lastChild();if(last)next=last;}while(last);return next;}var $9bf71ea28793e738$var$Tree=function(){function $9bf71ea28793e738$var$Tree(){_classCallCheck(this,$9bf71ea28793e738$var$Tree);this.fastMap=new Map();this.root=new $9bf71ea28793e738$var$TreeNode({scopeRef:null});this.fastMap.set(null,this.root);}_createClass($9bf71ea28793e738$var$Tree,[{key:\"size\",get:function get(){return this.fastMap.size;}},{key:\"getTreeNode\",value:function getTreeNode(data){return this.fastMap.get(data);}},{key:\"addTreeNode\",value:function addTreeNode(scopeRef,parent,nodeToRestore){var parentNode=this.fastMap.get(parent!==null&&parent!==void 0?parent:null);var node=new $9bf71ea28793e738$var$TreeNode({scopeRef:scopeRef});parentNode.addChild(node);node.parent=parentNode;this.fastMap.set(scopeRef,node);if(nodeToRestore)node.nodeToRestore=nodeToRestore;}},{key:\"removeTreeNode\",value:function removeTreeNode(scopeRef){if(scopeRef===null)return;var node=this.fastMap.get(scopeRef);var parentNode=node.parent;for(var _iterator2=_createForOfIteratorHelperLoose(this.traverse()),_step2;!(_step2=_iterator2()).done;){var current=_step2.value;if(current!==node&&node.nodeToRestore&&current.nodeToRestore&&node.scopeRef.current&&$9bf71ea28793e738$var$isElementInScope(current.nodeToRestore,node.scopeRef.current))current.nodeToRestore=node.nodeToRestore;}var children=node.children;parentNode.removeChild(node);if(children.length>0)children.forEach(function(child){return parentNode.addChild(child);});this.fastMap.delete(node.scopeRef);}},{key:\"traverse\",value:_regeneratorRuntime.mark(function traverse(){var node,_iterator3,_step3,child,_args=arguments;return _regeneratorRuntime.wrap(function traverse$(_context){while(1){switch(_context.prev=_context.next){case 0:node=_args.length>0&&_args[0]!==undefined?_args[0]:this.root;if(!(node.scopeRef!=null)){_context.next=4;break;}_context.next=4;return node;case 4:if(!(node.children.length>0)){_context.next=11;break;}_iterator3=_createForOfIteratorHelperLoose(node.children);case 6:if((_step3=_iterator3()).done){_context.next=11;break;}child=_step3.value;return _context.delegateYield(this.traverse(child),\"t0\",9);case 9:_context.next=6;break;case 11:case\"end\":return _context.stop();}}},traverse,this);})},{key:\"clone\",value:function clone(){var newTree=new $9bf71ea28793e738$var$Tree();for(var _iterator4=_createForOfIteratorHelperLoose(this.traverse()),_step4;!(_step4=_iterator4()).done;){var node=_step4.value;newTree.addTreeNode(node.scopeRef,node.parent.scopeRef,node.nodeToRestore);}return newTree;}}]);return $9bf71ea28793e738$var$Tree;}();var $9bf71ea28793e738$var$TreeNode=function(){function $9bf71ea28793e738$var$TreeNode(props){_classCallCheck(this,$9bf71ea28793e738$var$TreeNode);this.children=[];this.contain=false;this.scopeRef=props.scopeRef;}_createClass($9bf71ea28793e738$var$TreeNode,[{key:\"addChild\",value:function addChild(node){this.children.push(node);node.parent=this;}},{key:\"removeChild\",value:function removeChild(node){this.children.splice(this.children.indexOf(node),1);node.parent=undefined;}}]);return $9bf71ea28793e738$var$TreeNode;}();var $9bf71ea28793e738$export$d06fae2ee68b101e=new $9bf71ea28793e738$var$Tree();function $f7dceffc5ad7768b$export$4e328f61c538687f(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _props$autoFocus=props.autoFocus,autoFocus=_props$autoFocus===void 0?false:_props$autoFocus,isTextInput=props.isTextInput,within=props.within;var state=$6nfFC$useRef({isFocused:false,isFocusVisible:autoFocus||$6nfFC$isFocusVisible()});var _$6nfFC$useState=$6nfFC$useState(false),_$6nfFC$useState2=_slicedToArray(_$6nfFC$useState,2),isFocused1=_$6nfFC$useState2[0],setFocused=_$6nfFC$useState2[1];var _$6nfFC$useState3=$6nfFC$useState(function(){return state.current.isFocused&&state.current.isFocusVisible;}),_$6nfFC$useState4=_slicedToArray(_$6nfFC$useState3,2),isFocusVisibleState=_$6nfFC$useState4[0],setFocusVisible=_$6nfFC$useState4[1];var updateState=$6nfFC$useCallback(function(){return setFocusVisible(state.current.isFocused&&state.current.isFocusVisible);},[]);var onFocusChange=$6nfFC$useCallback(function(isFocused){state.current.isFocused=isFocused;setFocused(isFocused);updateState();},[updateState]);$6nfFC$useFocusVisibleListener(function(isFocusVisible){state.current.isFocusVisible=isFocusVisible;updateState();},[],{isTextInput:isTextInput});var _$6nfFC$useFocus=$6nfFC$useFocus({isDisabled:within,onFocusChange:onFocusChange}),focusProps=_$6nfFC$useFocus.focusProps;var _$6nfFC$useFocusWithi=$6nfFC$useFocusWithin({isDisabled:!within,onFocusWithinChange:onFocusChange}),focusWithinProps=_$6nfFC$useFocusWithi.focusWithinProps;return{isFocused:isFocused1,isFocusVisible:state.current.isFocused&&isFocusVisibleState,focusProps:within?focusWithinProps:focusProps};}function $907718708eab68af$export$1a38b4ad7f578e1d(props){var _$6nfFC$clsx;var children=props.children,focusClass=props.focusClass,focusRingClass=props.focusRingClass;var _$f7dceffc5ad7768b$ex=$f7dceffc5ad7768b$export$4e328f61c538687f(props),isFocused=_$f7dceffc5ad7768b$ex.isFocused,isFocusVisible=_$f7dceffc5ad7768b$ex.isFocusVisible,focusProps=_$f7dceffc5ad7768b$ex.focusProps;var child=$6nfFC$react.Children.only(children);return $6nfFC$react.cloneElement(child,$6nfFC$mergeProps(child.props,_objectSpread(_objectSpread({},focusProps),{},{className:$6nfFC$clsx((_$6nfFC$clsx={},_defineProperty(_$6nfFC$clsx,focusClass||'',isFocused),_defineProperty(_$6nfFC$clsx,focusRingClass||'',isFocusVisible),_$6nfFC$clsx))})));}var $e6afbd83fe6ebbd2$var$FocusableContext=$6nfFC$react.createContext(null);function $e6afbd83fe6ebbd2$var$useFocusableContext(ref){var context=$6nfFC$useContext($e6afbd83fe6ebbd2$var$FocusableContext)||{};$6nfFC$useSyncRef(context,ref);var _=context.ref,otherProps=_objectWithoutProperties(context,_excluded);return otherProps;}function $e6afbd83fe6ebbd2$var$FocusableProvider(props,ref){var children=props.children,otherProps=_objectWithoutProperties(props,_excluded2);var context=_objectSpread(_objectSpread({},otherProps),{},{ref:ref});return $6nfFC$react.createElement($e6afbd83fe6ebbd2$var$FocusableContext.Provider,{value:context},children);}var $e6afbd83fe6ebbd2$export$13f3202a3e5ddd5=$6nfFC$react.forwardRef($e6afbd83fe6ebbd2$var$FocusableProvider);function $e6afbd83fe6ebbd2$export$4c014de7c8940b4c(props,domRef){var _$6nfFC$useFocus2=$6nfFC$useFocus(props),focusProps=_$6nfFC$useFocus2.focusProps;var _$6nfFC$useKeyboard=$6nfFC$useKeyboard(props),keyboardProps=_$6nfFC$useKeyboard.keyboardProps;var interactions=$6nfFC$mergeProps(focusProps,keyboardProps);var domProps=$e6afbd83fe6ebbd2$var$useFocusableContext(domRef);var interactionProps=props.isDisabled?{}:domProps;var autoFocusRef=$6nfFC$useRef(props.autoFocus);$6nfFC$useEffect(function(){if(autoFocusRef.current&&domRef.current)$6a99195332edec8b$export$80f3e147d781571c(domRef.current);autoFocusRef.current=false;},[domRef]);return{focusableProps:$6nfFC$mergeProps(_objectSpread(_objectSpread({},interactions),{},{tabIndex:props.excludeFromTabOrder&&!props.isDisabled?-1:undefined}),interactionProps)};}export{$9bf71ea28793e738$export$20e40289641fbbb6 as FocusScope,$9bf71ea28793e738$export$10c5169755ce7bd7 as useFocusManager,$9bf71ea28793e738$export$2d6ec8fc375ceafa as getFocusableTreeWalker,$9bf71ea28793e738$export$c5251b9e124bf29 as createFocusManager,$907718708eab68af$export$1a38b4ad7f578e1d as FocusRing,$e6afbd83fe6ebbd2$export$13f3202a3e5ddd5 as FocusableProvider,$e6afbd83fe6ebbd2$export$4c014de7c8940b4c as useFocusable,$f7dceffc5ad7768b$export$4e328f61c538687f as useFocusRing,$6a99195332edec8b$export$80f3e147d781571c as focusSafely};","map":{"version":3,"sources":["packages/@react-aria/focus/src/FocusScope.tsx","packages/@react-aria/focus/src/focusSafely.ts","packages/@react-aria/focus/src/isElementVisible.ts","packages/@react-aria/focus/src/FocusRing.tsx","packages/@react-aria/focus/src/useFocusRing.ts","packages/@react-aria/focus/src/useFocusable.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {FocusableElement} from '@react-types/shared';\nimport {focusSafely} from './focusSafely';\nimport {isElementVisible} from './isElementVisible';\nimport React, {ReactNode, RefObject, useContext, useEffect, useMemo, useRef} from 'react';\nimport {useLayoutEffect} from '@react-aria/utils';\n\n\nexport interface FocusScopeProps {\n  /** The contents of the focus scope. */\n  children: ReactNode,\n\n  /**\n   * Whether to contain focus inside the scope, so users cannot\n   * move focus outside, for example in a modal dialog.\n   */\n  contain?: boolean,\n\n  /**\n   * Whether to restore focus back to the element that was focused\n   * when the focus scope mounted, after the focus scope unmounts.\n   */\n  restoreFocus?: boolean,\n\n  /** Whether to auto focus the first focusable element in the focus scope on mount. */\n  autoFocus?: boolean\n}\n\nexport interface FocusManagerOptions {\n  /** The element to start searching from. The currently focused element by default. */\n  from?: Element,\n  /** Whether to only include tabbable elements, or all focusable elements. */\n  tabbable?: boolean,\n  /** Whether focus should wrap around when it reaches the end of the scope. */\n  wrap?: boolean,\n  /** A callback that determines whether the given element is focused. */\n  accept?: (node: Element) => boolean\n}\n\nexport interface FocusManager {\n  /** Moves focus to the next focusable or tabbable element in the focus scope. */\n  focusNext(opts?: FocusManagerOptions): FocusableElement,\n  /** Moves focus to the previous focusable or tabbable element in the focus scope. */\n  focusPrevious(opts?: FocusManagerOptions): FocusableElement,\n  /** Moves focus to the first focusable or tabbable element in the focus scope. */\n  focusFirst(opts?: FocusManagerOptions): FocusableElement,\n    /** Moves focus to the last focusable or tabbable element in the focus scope. */\n  focusLast(opts?: FocusManagerOptions): FocusableElement\n}\n\ntype ScopeRef = RefObject<Element[]>;\ninterface IFocusContext {\n  scopeRef: ScopeRef,\n  focusManager: FocusManager\n}\n\nconst FocusContext = React.createContext<IFocusContext>(null);\n\nlet activeScope: ScopeRef = null;\n\n// This is a hacky DOM-based implementation of a FocusScope until this RFC lands in React:\n// https://github.com/reactjs/rfcs/pull/109\n\n/**\n * A FocusScope manages focus for its descendants. It supports containing focus inside\n * the scope, restoring focus to the previously focused element on unmount, and auto\n * focusing children on mount. It also acts as a container for a programmatic focus\n * management interface that can be used to move focus forward and back in response\n * to user events.\n */\nexport function FocusScope(props: FocusScopeProps) {\n  let {children, contain, restoreFocus, autoFocus} = props;\n  let startRef = useRef<HTMLSpanElement>();\n  let endRef = useRef<HTMLSpanElement>();\n  let scopeRef = useRef<Element[]>([]);\n  let ctx = useContext(FocusContext);\n\n  // The parent scope is based on the JSX tree, using context.\n  // However, if a new scope mounts outside the active scope (e.g. DialogContainer launched from a menu),\n  // we want the parent scope to be the active scope instead.\n  let ctxParent = ctx?.scopeRef ?? null;\n  let parentScope = useMemo(() => activeScope && focusScopeTree.getTreeNode(activeScope) && !isAncestorScope(activeScope, ctxParent) ? activeScope : ctxParent, [ctxParent]);\n\n  useLayoutEffect(() => {\n    // Find all rendered nodes between the sentinels and add them to the scope.\n    let node = startRef.current.nextSibling;\n    let nodes = [];\n    while (node && node !== endRef.current) {\n      nodes.push(node);\n      node = node.nextSibling;\n    }\n\n    scopeRef.current = nodes;\n  }, [children, parentScope]);\n\n  // add to the focus scope tree in render order because useEffects/useLayoutEffects run children first whereas render runs parent first\n  // which matters when constructing a tree\n  if (focusScopeTree.getTreeNode(parentScope) && !focusScopeTree.getTreeNode(scopeRef)) {\n    focusScopeTree.addTreeNode(scopeRef, parentScope);\n  }\n\n  let node = focusScopeTree.getTreeNode(scopeRef);\n  node.contain = contain;\n\n  useActiveScopeTracker(scopeRef, restoreFocus, contain);\n  useFocusContainment(scopeRef, contain);\n  useRestoreFocus(scopeRef, restoreFocus, contain);\n  useAutoFocus(scopeRef, autoFocus);\n\n  // this layout effect needs to run last so that focusScopeTree cleanup happens at the last moment possible\n  useLayoutEffect(() => {\n    if (scopeRef) {\n      return () => {\n        // Scope may have been re-parented.\n        let parentScope = focusScopeTree.getTreeNode(scopeRef).parent.scopeRef;\n\n        // Restore the active scope on unmount if this scope or a descendant scope is active.\n        // Parent effect cleanups run before children, so we need to check if the\n        // parent scope actually still exists before restoring the active scope to it.\n        if (\n          (scopeRef === activeScope || isAncestorScope(scopeRef, activeScope)) &&\n          (!parentScope || focusScopeTree.getTreeNode(parentScope))\n        ) {\n          activeScope = parentScope;\n        }\n        focusScopeTree.removeTreeNode(scopeRef);\n      };\n    }\n  }, [scopeRef, parentScope]);\n\n  let focusManager = createFocusManagerForScope(scopeRef);\n\n  return (\n    <FocusContext.Provider value={{scopeRef, focusManager}}>\n      <span data-focus-scope-start hidden ref={startRef} />\n      {children}\n      <span data-focus-scope-end hidden ref={endRef} />\n    </FocusContext.Provider>\n  );\n}\n\n/**\n * Returns a FocusManager interface for the parent FocusScope.\n * A FocusManager can be used to programmatically move focus within\n * a FocusScope, e.g. in response to user events like keyboard navigation.\n */\nexport function useFocusManager(): FocusManager {\n  return useContext(FocusContext)?.focusManager;\n}\n\nfunction createFocusManagerForScope(scopeRef: React.RefObject<Element[]>): FocusManager {\n  return {\n    focusNext(opts: FocusManagerOptions = {}) {\n      let scope = scopeRef.current;\n      let {from, tabbable, wrap, accept} = opts;\n      let node = from || document.activeElement;\n      let sentinel = scope[0].previousElementSibling;\n      let walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable, accept}, scope);\n      walker.currentNode = isElementInScope(node, scope) ? node : sentinel;\n      let nextNode = walker.nextNode() as FocusableElement;\n      if (!nextNode && wrap) {\n        walker.currentNode = sentinel;\n        nextNode = walker.nextNode() as FocusableElement;\n      }\n      if (nextNode) {\n        focusElement(nextNode, true);\n      }\n      return nextNode;\n    },\n    focusPrevious(opts: FocusManagerOptions = {}) {\n      let scope = scopeRef.current;\n      let {from, tabbable, wrap, accept} = opts;\n      let node = from || document.activeElement;\n      let sentinel = scope[scope.length - 1].nextElementSibling;\n      let walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable, accept}, scope);\n      walker.currentNode = isElementInScope(node, scope) ? node : sentinel;\n      let previousNode = walker.previousNode() as FocusableElement;\n      if (!previousNode && wrap) {\n        walker.currentNode = sentinel;\n        previousNode = walker.previousNode() as FocusableElement;\n      }\n      if (previousNode) {\n        focusElement(previousNode, true);\n      }\n      return previousNode;\n    },\n    focusFirst(opts = {}) {\n      let scope = scopeRef.current;\n      let {tabbable, accept} = opts;\n      let walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable, accept}, scope);\n      walker.currentNode = scope[0].previousElementSibling;\n      let nextNode = walker.nextNode() as FocusableElement;\n      if (nextNode) {\n        focusElement(nextNode, true);\n      }\n      return nextNode;\n    },\n    focusLast(opts = {}) {\n      let scope = scopeRef.current;\n      let {tabbable, accept} = opts;\n      let walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable, accept}, scope);\n      walker.currentNode = scope[scope.length - 1].nextElementSibling;\n      let previousNode = walker.previousNode() as FocusableElement;\n      if (previousNode) {\n        focusElement(previousNode, true);\n      }\n      return previousNode;\n    }\n  };\n}\n\nconst focusableElements = [\n  'input:not([disabled]):not([type=hidden])',\n  'select:not([disabled])',\n  'textarea:not([disabled])',\n  'button:not([disabled])',\n  'a[href]',\n  'area[href]',\n  'summary',\n  'iframe',\n  'object',\n  'embed',\n  'audio[controls]',\n  'video[controls]',\n  '[contenteditable]'\n];\n\nconst FOCUSABLE_ELEMENT_SELECTOR = focusableElements.join(':not([hidden]),') + ',[tabindex]:not([disabled]):not([hidden])';\n\nfocusableElements.push('[tabindex]:not([tabindex=\"-1\"]):not([disabled])');\nconst TABBABLE_ELEMENT_SELECTOR = focusableElements.join(':not([hidden]):not([tabindex=\"-1\"]),');\n\nfunction getScopeRoot(scope: Element[]) {\n  return scope[0].parentElement;\n}\n\nfunction shouldContainFocus(scopeRef: ScopeRef) {\n  let scope = focusScopeTree.getTreeNode(activeScope);\n  while (scope && scope.scopeRef !== scopeRef) {\n    if (scope.contain) {\n      return false;\n    }\n\n    scope = scope.parent;\n  }\n\n  return true;\n}\n\nfunction useFocusContainment(scopeRef: RefObject<Element[]>, contain: boolean) {\n  let focusedNode = useRef<FocusableElement>();\n\n  let raf = useRef(null);\n  useLayoutEffect(() => {\n    let scope = scopeRef.current;\n    if (!contain) {\n      // if contain was changed, then we should cancel any ongoing waits to pull focus back into containment\n      if (raf.current) {\n        cancelAnimationFrame(raf.current);\n        raf.current = null;\n      }\n      return;\n    }\n\n    // Handle the Tab key to contain focus within the scope\n    let onKeyDown = (e) => {\n      if (e.key !== 'Tab' || e.altKey || e.ctrlKey || e.metaKey || !shouldContainFocus(scopeRef)) {\n        return;\n      }\n\n      let focusedElement = document.activeElement;\n      let scope = scopeRef.current;\n      if (!isElementInScope(focusedElement, scope)) {\n        return;\n      }\n\n      let walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable: true}, scope);\n      walker.currentNode = focusedElement;\n      let nextElement = (e.shiftKey ? walker.previousNode() : walker.nextNode()) as FocusableElement;\n      if (!nextElement) {\n        walker.currentNode = e.shiftKey ? scope[scope.length - 1].nextElementSibling : scope[0].previousElementSibling;\n        nextElement = (e.shiftKey ? walker.previousNode() : walker.nextNode())  as FocusableElement;\n      }\n\n      e.preventDefault();\n      if (nextElement) {\n        focusElement(nextElement, true);\n      }\n    };\n\n    let onFocus = (e) => {\n      // If focusing an element in a child scope of the currently active scope, the child becomes active.\n      // Moving out of the active scope to an ancestor is not allowed.\n      if ((!activeScope || isAncestorScope(activeScope, scopeRef)) && isElementInScope(e.target, scopeRef.current)) {\n        activeScope = scopeRef;\n        focusedNode.current = e.target;\n      } else if (shouldContainFocus(scopeRef) && !isElementInChildScope(e.target, scopeRef)) {\n        // If a focus event occurs outside the active scope (e.g. user tabs from browser location bar),\n        // restore focus to the previously focused node or the first tabbable element in the active scope.\n        if (focusedNode.current) {\n          focusedNode.current.focus();\n        } else if (activeScope) {\n          focusFirstInScope(activeScope.current);\n        }\n      } else if (shouldContainFocus(scopeRef)) {\n        focusedNode.current = e.target;\n      }\n    };\n\n    let onBlur = (e) => {\n      // Firefox doesn't shift focus back to the Dialog properly without this\n      raf.current = requestAnimationFrame(() => {\n        // Use document.activeElement instead of e.relatedTarget so we can tell if user clicked into iframe\n        if (shouldContainFocus(scopeRef) && !isElementInChildScope(document.activeElement, scopeRef)) {\n          activeScope = scopeRef;\n          if (document.body.contains(e.target)) {\n            focusedNode.current = e.target;\n            focusedNode.current.focus();\n          } else if (activeScope) {\n            focusFirstInScope(activeScope.current);\n          }\n        }\n      });\n    };\n\n    document.addEventListener('keydown', onKeyDown, false);\n    document.addEventListener('focusin', onFocus, false);\n    scope.forEach(element => element.addEventListener('focusin', onFocus, false));\n    scope.forEach(element => element.addEventListener('focusout', onBlur, false));\n    return () => {\n      document.removeEventListener('keydown', onKeyDown, false);\n      document.removeEventListener('focusin', onFocus, false);\n      scope.forEach(element => element.removeEventListener('focusin', onFocus, false));\n      scope.forEach(element => element.removeEventListener('focusout', onBlur, false));\n    };\n  }, [scopeRef, contain]);\n\n  // eslint-disable-next-line arrow-body-style\n  useEffect(() => {\n    return () => {\n      if (raf.current) {\n        cancelAnimationFrame(raf.current);\n      }\n    };\n  }, [raf]);\n}\n\nfunction isElementInAnyScope(element: Element) {\n  return isElementInChildScope(element);\n}\n\nfunction isElementInScope(element: Element, scope: Element[]) {\n  return scope.some(node => node.contains(element));\n}\n\nfunction isElementInChildScope(element: Element, scope: ScopeRef = null) {\n  // node.contains in isElementInScope covers child scopes that are also DOM children,\n  // but does not cover child scopes in portals.\n  for (let {scopeRef: s} of focusScopeTree.traverse(focusScopeTree.getTreeNode(scope))) {\n    if (isElementInScope(element, s.current)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction isAncestorScope(ancestor: ScopeRef, scope: ScopeRef) {\n  let parent = focusScopeTree.getTreeNode(scope)?.parent;\n  while (parent) {\n    if (parent.scopeRef === ancestor) {\n      return true;\n    }\n    parent = parent.parent;\n  }\n  return false;\n}\n\nfunction focusElement(element: FocusableElement | null, scroll = false) {\n  if (element != null && !scroll) {\n    try {\n      focusSafely(element);\n    } catch (err) {\n      // ignore\n    }\n  } else if (element != null) {\n    try {\n      element.focus();\n    } catch (err) {\n      // ignore\n    }\n  }\n}\n\nfunction focusFirstInScope(scope: Element[], tabbable:boolean = true) {\n  let sentinel = scope[0].previousElementSibling;\n  let walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable}, scope);\n  walker.currentNode = sentinel;\n  let nextNode = walker.nextNode();\n\n  // If the scope does not contain a tabbable element, use the first focusable element.\n  if (tabbable && !nextNode) {\n    walker = getFocusableTreeWalker(getScopeRoot(scope), {tabbable: false}, scope);\n    walker.currentNode = sentinel;\n    nextNode = walker.nextNode();\n  }\n\n  focusElement(nextNode as FocusableElement);\n}\n\nfunction useAutoFocus(scopeRef: RefObject<Element[]>, autoFocus: boolean) {\n  const autoFocusRef = React.useRef(autoFocus);\n  useEffect(() => {\n    if (autoFocusRef.current) {\n      activeScope = scopeRef;\n      if (!isElementInScope(document.activeElement, activeScope.current)) {\n        focusFirstInScope(scopeRef.current);\n      }\n    }\n    autoFocusRef.current = false;\n  }, [scopeRef]);\n}\n\nfunction useActiveScopeTracker(scopeRef: RefObject<Element[]>, restore: boolean, contain: boolean) {\n  // tracks the active scope, in case restore and contain are both false.\n  // if either are true, this is tracked in useRestoreFocus or useFocusContainment.\n  useLayoutEffect(() => {\n    if (restore || contain) {\n      return;\n    }\n\n    let scope = scopeRef.current;\n\n    let onFocus = (e: FocusEvent) => {\n      let target = e.target as Element;\n      if (isElementInScope(target, scopeRef.current)) {\n        activeScope = scopeRef;\n      } else if (!isElementInAnyScope(target)) {\n        activeScope = null;\n      }\n    };\n\n    document.addEventListener('focusin', onFocus, false);\n    scope.forEach(element => element.addEventListener('focusin', onFocus, false));\n    return () => {\n      document.removeEventListener('focusin', onFocus, false);\n      scope.forEach(element => element.removeEventListener('focusin', onFocus, false));\n    };\n  }, [scopeRef, restore, contain]);\n}\n\nfunction shouldRestoreFocus(scopeRef: ScopeRef) {\n  let scope = focusScopeTree.getTreeNode(activeScope);\n  while (scope && scope.scopeRef !== scopeRef) {\n    if (scope.nodeToRestore) {\n      return false;\n    }\n\n    scope = scope.parent;\n  }\n\n  return true;\n}\n\nfunction useRestoreFocus(scopeRef: RefObject<Element[]>, restoreFocus: boolean, contain: boolean) {\n  // create a ref during render instead of useLayoutEffect so the active element is saved before a child with autoFocus=true mounts.\n  const nodeToRestoreRef = useRef(typeof document !== 'undefined' ? document.activeElement as FocusableElement : null);\n\n  // restoring scopes should all track if they are active regardless of contain, but contain already tracks it plus logic to contain the focus\n  // restoring-non-containing scopes should only care if they become active so they can perform the restore\n  useLayoutEffect(() => {\n    let scope = scopeRef.current;\n    if (!restoreFocus || contain) {\n      return;\n    }\n\n    let onFocus = () => {\n      // If focusing an element in a child scope of the currently active scope, the child becomes active.\n      // Moving out of the active scope to an ancestor is not allowed.\n      if (!activeScope || isAncestorScope(activeScope, scopeRef)) {\n        activeScope = scopeRef;\n      }\n    };\n\n    document.addEventListener('focusin', onFocus, false);\n    scope.forEach(element => element.addEventListener('focusin', onFocus, false));\n    return () => {\n      document.removeEventListener('focusin', onFocus, false);\n      scope.forEach(element => element.removeEventListener('focusin', onFocus, false));\n    };\n  }, [scopeRef, contain]);\n\n  // useLayoutEffect instead of useEffect so the active element is saved synchronously instead of asynchronously.\n  useLayoutEffect(() => {\n    if (!restoreFocus) {\n      return;\n    }\n\n    focusScopeTree.getTreeNode(scopeRef).nodeToRestore = nodeToRestoreRef.current;\n\n    // Handle the Tab key so that tabbing out of the scope goes to the next element\n    // after the node that had focus when the scope mounted. This is important when\n    // using portals for overlays, so that focus goes to the expected element when\n    // tabbing out of the overlay.\n    let onKeyDown = (e: KeyboardEvent) => {\n      if (e.key !== 'Tab' || e.altKey || e.ctrlKey || e.metaKey) {\n        return;\n      }\n\n      let focusedElement = document.activeElement as FocusableElement;\n      if (!isElementInScope(focusedElement, scopeRef.current)) {\n        return;\n      }\n      let nodeToRestore = focusScopeTree.getTreeNode(scopeRef).nodeToRestore;\n\n      // Create a DOM tree walker that matches all tabbable elements\n      let walker = getFocusableTreeWalker(document.body, {tabbable: true});\n\n      // Find the next tabbable element after the currently focused element\n      walker.currentNode = focusedElement;\n      let nextElement = (e.shiftKey ? walker.previousNode() : walker.nextNode()) as FocusableElement;\n\n      if (!document.body.contains(nodeToRestore) || nodeToRestore === document.body) {\n        nodeToRestore = null;\n        focusScopeTree.getTreeNode(scopeRef).nodeToRestore = null;\n      }\n\n      // If there is no next element, or it is outside the current scope, move focus to the\n      // next element after the node to restore to instead.\n      if ((!nextElement || !isElementInScope(nextElement, scopeRef.current)) && nodeToRestore) {\n        walker.currentNode = nodeToRestore;\n\n        // Skip over elements within the scope, in case the scope immediately follows the node to restore.\n        do {\n          nextElement = (e.shiftKey ? walker.previousNode() : walker.nextNode()) as FocusableElement;\n        } while (isElementInScope(nextElement, scopeRef.current));\n\n        e.preventDefault();\n        e.stopPropagation();\n        if (nextElement) {\n          focusElement(nextElement, true);\n        } else {\n           // If there is no next element and the nodeToRestore isn't within a FocusScope (i.e. we are leaving the top level focus scope)\n           // then move focus to the body.\n           // Otherwise restore focus to the nodeToRestore (e.g menu within a popover -> tabbing to close the menu should move focus to menu trigger)\n          if (!isElementInAnyScope(nodeToRestore)) {\n            focusedElement.blur();\n          } else {\n            focusElement(nodeToRestore, true);\n          }\n        }\n      }\n    };\n\n    if (!contain) {\n      document.addEventListener('keydown', onKeyDown, true);\n    }\n\n    return () => {\n      if (!contain) {\n        document.removeEventListener('keydown', onKeyDown, true);\n      }\n      let nodeToRestore = focusScopeTree.getTreeNode(scopeRef).nodeToRestore;\n\n      // if we already lost focus to the body and this was the active scope, then we should attempt to restore\n      if (\n        restoreFocus\n        && nodeToRestore\n        && (\n          isElementInScope(document.activeElement, scopeRef.current)\n          || (document.activeElement === document.body && shouldRestoreFocus(scopeRef))\n        )\n      ) {\n        // freeze the focusScopeTree so it persists after the raf, otherwise during unmount nodes are removed from it\n        let clonedTree = focusScopeTree.clone();\n        requestAnimationFrame(() => {\n          // Only restore focus if we've lost focus to the body, the alternative is that focus has been purposefully moved elsewhere\n          if (document.activeElement === document.body) {\n            // look up the tree starting with our scope to find a nodeToRestore still in the DOM\n            let treeNode = clonedTree.getTreeNode(scopeRef);\n            while (treeNode) {\n              if (treeNode.nodeToRestore && document.body.contains(treeNode.nodeToRestore)) {\n                focusElement(treeNode.nodeToRestore);\n                return;\n              }\n              treeNode = treeNode.parent;\n            }\n\n            // If no nodeToRestore was found, focus the first element in the nearest\n            // ancestor scope that is still in the tree.\n            treeNode = clonedTree.getTreeNode(scopeRef);\n            while (treeNode) {\n              if (treeNode.scopeRef && focusScopeTree.getTreeNode(treeNode.scopeRef)) {\n                focusFirstInScope(treeNode.scopeRef.current, true);\n                return;\n              }\n              treeNode = treeNode.parent;\n            }\n          }\n        });\n      }\n    };\n  }, [scopeRef, restoreFocus, contain]);\n}\n\n/**\n * Create a [TreeWalker]{@link https://developer.mozilla.org/en-US/docs/Web/API/TreeWalker}\n * that matches all focusable/tabbable elements.\n */\nexport function getFocusableTreeWalker(root: Element, opts?: FocusManagerOptions, scope?: Element[]) {\n  let selector = opts?.tabbable ? TABBABLE_ELEMENT_SELECTOR : FOCUSABLE_ELEMENT_SELECTOR;\n  let walker = document.createTreeWalker(\n    root,\n    NodeFilter.SHOW_ELEMENT,\n    {\n      acceptNode(node) {\n        // Skip nodes inside the starting node.\n        if (opts?.from?.contains(node)) {\n          return NodeFilter.FILTER_REJECT;\n        }\n\n        if ((node as Element).matches(selector)\n          && isElementVisible(node as Element)\n          && (!scope || isElementInScope(node as Element, scope))\n          && (!opts?.accept || opts.accept(node as Element))\n        ) {\n          return NodeFilter.FILTER_ACCEPT;\n        }\n\n        return NodeFilter.FILTER_SKIP;\n      }\n    }\n  );\n\n  if (opts?.from) {\n    walker.currentNode = opts.from;\n  }\n\n  return walker;\n}\n\n/**\n * Creates a FocusManager object that can be used to move focus within an element.\n */\nexport function createFocusManager(ref: RefObject<Element>, defaultOptions: FocusManagerOptions = {}): FocusManager {\n  return {\n    focusNext(opts: FocusManagerOptions = {}) {\n      let root = ref.current;\n      if (!root) {\n        return;\n      }\n      let {from, tabbable = defaultOptions.tabbable, wrap = defaultOptions.wrap, accept = defaultOptions.accept} = opts;\n      let node = from || document.activeElement;\n      let walker = getFocusableTreeWalker(root, {tabbable, accept});\n      if (root.contains(node)) {\n        walker.currentNode = node;\n      }\n      let nextNode = walker.nextNode() as FocusableElement;\n      if (!nextNode && wrap) {\n        walker.currentNode = root;\n        nextNode = walker.nextNode() as FocusableElement;\n      }\n      if (nextNode) {\n        focusElement(nextNode, true);\n      }\n      return nextNode;\n    },\n    focusPrevious(opts: FocusManagerOptions = defaultOptions) {\n      let root = ref.current;\n      if (!root) {\n        return;\n      }\n      let {from, tabbable = defaultOptions.tabbable, wrap = defaultOptions.wrap, accept = defaultOptions.accept} = opts;\n      let node = from || document.activeElement;\n      let walker = getFocusableTreeWalker(root, {tabbable, accept});\n      if (root.contains(node)) {\n        walker.currentNode = node;\n      } else {\n        let next = last(walker);\n        if (next) {\n          focusElement(next, true);\n        }\n        return next;\n      }\n      let previousNode = walker.previousNode() as FocusableElement;\n      if (!previousNode && wrap) {\n        walker.currentNode = root;\n        previousNode = last(walker);\n      }\n      if (previousNode) {\n        focusElement(previousNode, true);\n      }\n      return previousNode;\n    },\n    focusFirst(opts = defaultOptions) {\n      let root = ref.current;\n      if (!root) {\n        return;\n      }\n      let {tabbable = defaultOptions.tabbable, accept = defaultOptions.accept} = opts;\n      let walker = getFocusableTreeWalker(root, {tabbable, accept});\n      let nextNode = walker.nextNode() as FocusableElement;\n      if (nextNode) {\n        focusElement(nextNode, true);\n      }\n      return nextNode;\n    },\n    focusLast(opts = defaultOptions) {\n      let root = ref.current;\n      if (!root) {\n        return;\n      }\n      let {tabbable = defaultOptions.tabbable, accept = defaultOptions.accept} = opts;\n      let walker = getFocusableTreeWalker(root, {tabbable, accept});\n      let next = last(walker);\n      if (next) {\n        focusElement(next, true);\n      }\n      return next;\n    }\n  };\n}\n\nfunction last(walker: TreeWalker) {\n  let next: FocusableElement;\n  let last: FocusableElement;\n  do {\n    last = walker.lastChild() as FocusableElement;\n    if (last) {\n      next = last;\n    }\n  } while (last);\n  return next;\n}\n\n\nclass Tree {\n  private root: TreeNode;\n  private fastMap = new Map<ScopeRef, TreeNode>();\n\n  constructor() {\n    this.root = new TreeNode({scopeRef: null});\n    this.fastMap.set(null, this.root);\n  }\n\n  get size() {\n    return this.fastMap.size;\n  }\n\n  getTreeNode(data: ScopeRef) {\n    return this.fastMap.get(data);\n  }\n\n  addTreeNode(scopeRef: ScopeRef, parent: ScopeRef, nodeToRestore?: FocusableElement) {\n    let parentNode = this.fastMap.get(parent ?? null);\n    let node = new TreeNode({scopeRef});\n    parentNode.addChild(node);\n    node.parent = parentNode;\n    this.fastMap.set(scopeRef, node);\n    if (nodeToRestore) {\n      node.nodeToRestore = nodeToRestore;\n    }\n  }\n\n  removeTreeNode(scopeRef: ScopeRef) {\n    // never remove the root\n    if (scopeRef === null) {\n      return;\n    }\n    let node = this.fastMap.get(scopeRef);\n    let parentNode = node.parent;\n    // when we remove a scope, check if any sibling scopes are trying to restore focus to something inside the scope we're removing\n    // if we are, then replace the siblings restore with the restore from the scope we're removing\n    for (let current of this.traverse()) {\n      if (\n        current !== node &&\n        node.nodeToRestore &&\n        current.nodeToRestore &&\n        node.scopeRef.current &&\n        isElementInScope(current.nodeToRestore, node.scopeRef.current)\n      ) {\n        current.nodeToRestore = node.nodeToRestore;\n      }\n    }\n    let children = node.children;\n    parentNode.removeChild(node);\n    if (children.length > 0) {\n      children.forEach(child => parentNode.addChild(child));\n    }\n    this.fastMap.delete(node.scopeRef);\n  }\n\n  // Pre Order Depth First\n  *traverse(node: TreeNode = this.root): Generator<TreeNode> {\n    if (node.scopeRef != null) {\n      yield node;\n    }\n    if (node.children.length > 0) {\n      for (let child of node.children) {\n        yield* this.traverse(child);\n      }\n    }\n  }\n\n  clone(): Tree {\n    let newTree = new Tree();\n    for (let node of this.traverse()) {\n      newTree.addTreeNode(node.scopeRef, node.parent.scopeRef, node.nodeToRestore);\n    }\n    return newTree;\n  }\n}\n\nclass TreeNode {\n  public scopeRef: ScopeRef;\n  public nodeToRestore: FocusableElement;\n  public parent: TreeNode;\n  public children: TreeNode[] = [];\n  public contain = false;\n\n  constructor(props: {scopeRef: ScopeRef}) {\n    this.scopeRef = props.scopeRef;\n  }\n  addChild(node: TreeNode) {\n    this.children.push(node);\n    node.parent = this;\n  }\n  removeChild(node: TreeNode) {\n    this.children.splice(this.children.indexOf(node), 1);\n    node.parent = undefined;\n  }\n}\n\nexport let focusScopeTree = new Tree();\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {FocusableElement} from '@react-types/shared';\nimport {focusWithoutScrolling, runAfterTransition} from '@react-aria/utils';\nimport {getInteractionModality} from '@react-aria/interactions';\n\n/**\n * A utility function that focuses an element while avoiding undesired side effects such\n * as page scrolling and screen reader issues with CSS transitions.\n */\nexport function focusSafely(element: FocusableElement) {\n  // If the user is interacting with a virtual cursor, e.g. screen reader, then\n  // wait until after any animated transitions that are currently occurring on\n  // the page before shifting focus. This avoids issues with VoiceOver on iOS\n  // causing the page to scroll when moving focus if the element is transitioning\n  // from off the screen.\n  if (getInteractionModality() === 'virtual') {\n    let lastFocusedElement = document.activeElement;\n    runAfterTransition(() => {\n      // If focus did not move and the element is still in the document, focus it.\n      if (document.activeElement === lastFocusedElement && document.contains(element)) {\n        focusWithoutScrolling(element);\n      }\n    });\n  } else {\n    focusWithoutScrolling(element);\n  }\n}\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nfunction isStyleVisible(element: Element) {\n  if (!(element instanceof HTMLElement) && !(element instanceof SVGElement)) {\n    return false;\n  }\n\n  let {display, visibility} = element.style;\n\n  let isVisible = (\n    display !== 'none' &&\n    visibility !== 'hidden' &&\n    visibility !== 'collapse'\n  );\n\n  if (isVisible) {\n    const {getComputedStyle} = element.ownerDocument.defaultView;\n    let {display: computedDisplay, visibility: computedVisibility} = getComputedStyle(element);\n\n    isVisible = (\n      computedDisplay !== 'none' &&\n      computedVisibility !== 'hidden' &&\n      computedVisibility !== 'collapse'\n    );\n  }\n\n  return isVisible;\n}\n\nfunction isAttributeVisible(element: Element, childElement?: Element) {\n  return (\n    !element.hasAttribute('hidden') &&\n    (element.nodeName === 'DETAILS' &&\n      childElement &&\n      childElement.nodeName !== 'SUMMARY'\n      ? element.hasAttribute('open')\n      : true)\n  );\n}\n\n/**\n * Adapted from https://github.com/testing-library/jest-dom and \n * https://github.com/vuejs/vue-test-utils-next/.\n * Licensed under the MIT License.\n * @param element - Element to evaluate for display or visibility.\n */  \nexport function isElementVisible(element: Element, childElement?: Element) {\n  return (\n    element.nodeName !== '#comment' &&\n    isStyleVisible(element) &&\n    isAttributeVisible(element, childElement) &&\n    (!element.parentElement || isElementVisible(element.parentElement, element))\n  );\n}\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport clsx from 'clsx';\nimport {mergeProps} from '@react-aria/utils';\nimport React, {ReactElement} from 'react';\nimport {useFocusRing} from './useFocusRing';\n\nexport interface FocusRingProps {\n  /** Child element to apply CSS classes to. */\n  children: ReactElement,\n  /** CSS class to apply when the element is focused. */\n  focusClass?: string,\n  /** CSS class to apply when the element has keyboard focus. */\n  focusRingClass?: string,\n  /**\n   * Whether to show the focus ring when something\n   * inside the container element has focus (true), or\n   * only if the container itself has focus (false).\n   * @default false\n   */\n  within?: boolean,\n  /** Whether the element is a text input. */\n  isTextInput?: boolean,\n  /** Whether the element will be auto focused. */\n  autoFocus?: boolean\n}\n\n/**\n * A utility component that applies a CSS class when an element has keyboard focus.\n * Focus rings are visible only when the user is interacting with a keyboard,\n * not with a mouse, touch, or other input methods.\n */\nexport function FocusRing(props: FocusRingProps) {\n  let {children, focusClass, focusRingClass} = props;\n  let {isFocused, isFocusVisible, focusProps} = useFocusRing(props);\n  let child = React.Children.only(children);\n\n  return React.cloneElement(child, mergeProps(child.props, {\n    ...focusProps,\n    className: clsx({\n      [focusClass || '']: isFocused,\n      [focusRingClass || '']: isFocusVisible\n    })\n  }));\n}\n","import {DOMAttributes} from '@react-types/shared';\nimport {isFocusVisible, useFocus, useFocusVisibleListener, useFocusWithin} from '@react-aria/interactions';\nimport {useCallback, useState} from 'react';\nimport {useRef} from 'react';\n\nexport interface AriaFocusRingProps {\n  /**\n   * Whether to show the focus ring when something\n   * inside the container element has focus (true), or\n   * only if the container itself has focus (false).\n   * @default 'false'\n   */\n  within?: boolean,\n\n  /** Whether the element is a text input. */\n  isTextInput?: boolean,\n\n  /** Whether the element will be auto focused. */\n  autoFocus?: boolean\n}\n\nexport interface FocusRingAria {\n  /** Whether the element is currently focused. */\n  isFocused: boolean,\n\n  /** Whether keyboard focus should be visible. */\n  isFocusVisible: boolean,\n\n  /** Props to apply to the container element with the focus ring. */\n  focusProps: DOMAttributes\n}\n\n/**\n * Determines whether a focus ring should be shown to indicate keyboard focus.\n * Focus rings are visible only when the user is interacting with a keyboard,\n * not with a mouse, touch, or other input methods.\n */\nexport function useFocusRing(props: AriaFocusRingProps = {}): FocusRingAria {\n  let {\n    autoFocus = false,\n    isTextInput,\n    within\n  } = props;\n  let state = useRef({\n    isFocused: false,\n    isFocusVisible: autoFocus || isFocusVisible()\n  });\n  let [isFocused, setFocused] = useState(false);\n  let [isFocusVisibleState, setFocusVisible] = useState(() => state.current.isFocused && state.current.isFocusVisible);\n\n  let updateState = useCallback(() => setFocusVisible(state.current.isFocused && state.current.isFocusVisible), []);\n\n  let onFocusChange = useCallback(isFocused => {\n    state.current.isFocused = isFocused;\n    setFocused(isFocused);\n    updateState();\n  }, [updateState]);\n\n  useFocusVisibleListener((isFocusVisible) => {\n    state.current.isFocusVisible = isFocusVisible;\n    updateState();\n  }, [], {isTextInput});\n\n  let {focusProps} = useFocus({\n    isDisabled: within,\n    onFocusChange\n  });\n\n  let {focusWithinProps} = useFocusWithin({\n    isDisabled: !within,\n    onFocusWithinChange: onFocusChange\n  });\n\n  return {\n    isFocused,\n    isFocusVisible: state.current.isFocused && isFocusVisibleState,\n    focusProps: within ? focusWithinProps : focusProps\n  };\n}\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {DOMAttributes, FocusableDOMProps, FocusableElement, FocusableProps} from '@react-types/shared';\nimport {focusSafely} from './';\nimport {mergeProps, useSyncRef} from '@react-aria/utils';\nimport React, {MutableRefObject, ReactNode, RefObject, useContext, useEffect, useRef} from 'react';\nimport {useFocus, useKeyboard} from '@react-aria/interactions';\n\nexport interface FocusableOptions extends FocusableProps, FocusableDOMProps {\n  /** Whether focus should be disabled. */\n  isDisabled?: boolean\n}\n\nexport interface FocusableProviderProps extends DOMAttributes {\n  /** The child element to provide DOM props to. */\n  children?: ReactNode\n}\n\ninterface FocusableContextValue extends FocusableProviderProps {\n  ref?: MutableRefObject<FocusableElement>\n}\n\nlet FocusableContext = React.createContext<FocusableContextValue>(null);\n\nfunction useFocusableContext(ref: RefObject<FocusableElement>): FocusableContextValue {\n  let context = useContext(FocusableContext) || {};\n  useSyncRef(context, ref);\n\n  // eslint-disable-next-line\n  let {ref: _, ...otherProps} = context;\n  return otherProps;\n}\n\n/**\n * Provides DOM props to the nearest focusable child.\n */\nfunction FocusableProvider(props: FocusableProviderProps, ref: RefObject<FocusableElement>) {\n  let {children, ...otherProps} = props;\n  let context = {\n    ...otherProps,\n    ref\n  };\n\n  return (\n    <FocusableContext.Provider value={context}>\n      {children}\n    </FocusableContext.Provider>\n  );\n}\n\nlet _FocusableProvider = React.forwardRef(FocusableProvider);\nexport {_FocusableProvider as FocusableProvider};\n\nexport interface FocusableAria {\n  /** Props for the focusable element. */\n  focusableProps: DOMAttributes\n}\n\n/**\n * Used to make an element focusable and capable of auto focus.\n */\nexport function useFocusable(props: FocusableOptions, domRef: RefObject<FocusableElement>): FocusableAria {\n  let {focusProps} = useFocus(props);\n  let {keyboardProps} = useKeyboard(props);\n  let interactions = mergeProps(focusProps, keyboardProps);\n  let domProps = useFocusableContext(domRef);\n  let interactionProps = props.isDisabled ? {} : domProps;\n  let autoFocusRef = useRef(props.autoFocus);\n\n  useEffect(() => {\n    if (autoFocusRef.current && domRef.current) {\n      focusSafely(domRef.current);\n    }\n    autoFocusRef.current = false;\n  }, [domRef]);\n\n  return {\n    focusableProps: mergeProps(\n      {\n        ...interactions,\n        tabIndex: props.excludeFromTabOrder && !props.isDisabled ? -1 : undefined\n      },\n      interactionProps\n    )\n  };\n}\n"]},"metadata":{},"sourceType":"module"}