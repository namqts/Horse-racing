{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"children\"],_excluded2=[\"manageFocus\",\"defaultValue\",\"value\",\"space\",\"onChange\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React from'react';import{HStack}from\"../../primitives/Stack\";import{useThemeProps}from\"../../../hooks\";import{useFormControlContext}from\"../FormControl\";import Platform from\"react-native-web/dist/exports/Platform\";import{PinInputContext}from\"./Context\";import{themeTools}from\"../../../theme\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";var PinInput=function PinInput(_ref,ref){var children=_ref.children,props=_objectWithoutProperties(_ref,_excluded);var _themeTools$extractIn=themeTools.extractInObject(props,['p','px','py','pt','pb','pl','pr']),_themeTools$extractIn2=_slicedToArray(_themeTools$extractIn,2),padding=_themeTools$extractIn2[0],remProps=_themeTools$extractIn2[1];var _useThemeProps=useThemeProps('PinInput',remProps),manageFocus=_useThemeProps.manageFocus,defaultValue=_useThemeProps.defaultValue,value=_useThemeProps.value,space=_useThemeProps.space,onChange=_useThemeProps.onChange,newProps=_objectWithoutProperties(_useThemeProps,_excluded2);var formControlContext=useFormControlContext();var RefList=[];var setRefList=function setRefList(ref,index){RefList[index]=ref;};var _React$useState=React.useState(value||defaultValue),_React$useState2=_slicedToArray(_React$useState,2),pinInputValue=_React$useState2[0],setPinInputValue=_React$useState2[1];var handleChange=function handleChange(newValue,fieldIndex){var temp=pinInputValue&&_toConsumableArray(pinInputValue)||[];temp[fieldIndex]=newValue;value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));if(newValue===''&&manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();else if(newValue&&manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();return temp.join('');};var handleMultiValueChange=function handleMultiValueChange(newValue,fieldIndex){var pinFieldLength=RefList.length;var newValueLength=newValue.length;if(newValueLength>=pinFieldLength&&newValueLength>2){var splicedValue=newValue?_toConsumableArray(newValue):[];splicedValue.splice(pinFieldLength);RefList[pinFieldLength-1].current.focus();setPinInputValue(splicedValue.join(''));onChange&&onChange(splicedValue.join(''));}if(Platform.OS!=='ios'){var temp=pinInputValue?_toConsumableArray(pinInputValue):[];if(newValue===''){temp=temp.filter(function(_n,i){return i!==fieldIndex;});if(manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();}else{temp[fieldIndex]=JSON.stringify(parseInt(newValue,10)%10);if(manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();}value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));}};var indexSetter=function indexSetter(allChildren){var pinInputFiledCounter=-1;return React.Children.map(allChildren,function(child){pinInputFiledCounter++;return React.cloneElement(child,{fieldIndex:pinInputFiledCounter},child.props.children);});};React.useEffect(function(){if(value!==undefined&&value!=pinInputValue)setPinInputValue(value);},[value,pinInputValue,setPinInputValue]);if(useHasResponsiveProps(props)){return null;}return React.createElement(PinInputContext.Provider,{value:_objectSpread(_objectSpread(_objectSpread({},formControlContext),newProps),{},{setRefList:setRefList,handleChange:handleChange,handleMultiValueChange:handleMultiValueChange,value:pinInputValue})},children&&React.createElement(HStack,_extends({flexDirection:\"row\",space:space},padding,{ref:ref}),indexSetter(children)));};export default React.memo(React.forwardRef(PinInput));","map":{"version":3,"sources":["PinInput.tsx"],"names":["React","HStack","useThemeProps","useFormControlContext","PinInputContext","themeTools","useHasResponsiveProps","PinInput","children","props","ref","padding","remProps","extractInObject","manageFocus","defaultValue","value","space","onChange","newProps","formControlContext","RefList","setRefList","index","pinInputValue","setPinInputValue","useState","handleChange","newValue","fieldIndex","temp","undefined","join","current","focus","length","handleMultiValueChange","pinFieldLength","newValueLength","splicedValue","splice","Platform","OS","filter","_n","i","JSON","stringify","parseInt","indexSetter","allChildren","pinInputFiledCounter","Children","map","child","cloneElement","useEffect","memo","forwardRef"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { HStack } from '../../primitives/Stack';\nimport { useThemeProps } from '../../../hooks';\nimport type { IPinInputProps } from './types';\nimport { useFormControlContext } from '../FormControl';\nimport { Platform } from 'react-native';\nimport { PinInputContext } from './Context';\nimport { themeTools } from '../../../theme';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst PinInput = ({ children, ...props }: IPinInputProps, ref?: any) => {\n  let [padding, remProps] = themeTools.extractInObject(props, [\n    'p',\n    'px',\n    'py',\n    'pt',\n    'pb',\n    'pl',\n    'pr',\n  ]);\n  const {\n    manageFocus,\n    defaultValue,\n    value,\n    space,\n    onChange,\n    ...newProps\n  } = useThemeProps('PinInput', remProps);\n  const formControlContext = useFormControlContext();\n\n  const RefList: Array<any> = [];\n  const setRefList = (ref: any, index: number) => {\n    RefList[index] = ref;\n  };\n  const [pinInputValue, setPinInputValue] = React.useState(\n    value || defaultValue\n  );\n\n  const handleChange = (newValue: string, fieldIndex: number) => {\n    let temp = (pinInputValue && [...pinInputValue]) || [];\n    temp[fieldIndex] = newValue;\n    value === undefined && setPinInputValue(temp.join(''));\n    onChange && onChange(temp.join(''));\n    if (newValue === '' && manageFocus && fieldIndex - 1 > -1)\n      RefList[fieldIndex - 1].current.focus();\n    else if (newValue && manageFocus && fieldIndex + 1 < RefList.length)\n      RefList[fieldIndex + 1].current.focus();\n    return temp.join('');\n  };\n  const handleMultiValueChange = (newValue: string, fieldIndex: number) => {\n    const pinFieldLength = RefList.length;\n    const newValueLength = newValue.length;\n    if (newValueLength >= pinFieldLength && newValueLength > 2) {\n      let splicedValue = newValue ? [...newValue] : [];\n      splicedValue.splice(pinFieldLength);\n      RefList[pinFieldLength - 1].current.focus();\n      setPinInputValue(splicedValue.join(''));\n      onChange && onChange(splicedValue.join(''));\n    }\n\n    if (Platform.OS !== 'ios') {\n      let temp = pinInputValue ? [...pinInputValue] : [];\n      if (newValue === '') {\n        // Handling Backward focus.\n        temp = temp.filter((_n, i) => i !== fieldIndex);\n        if (manageFocus && fieldIndex - 1 > -1)\n          RefList[fieldIndex - 1].current.focus();\n      } else {\n        temp[fieldIndex] = JSON.stringify(parseInt(newValue, 10) % 10);\n        if (manageFocus && fieldIndex + 1 < RefList.length)\n          RefList[fieldIndex + 1].current.focus();\n      }\n      value === undefined && setPinInputValue(temp.join(''));\n      onChange && onChange(temp.join(''));\n    }\n  };\n\n  const indexSetter = (allChildren: JSX.Element | JSX.Element[]) => {\n    let pinInputFiledCounter = -1;\n    return React.Children.map(allChildren, (child: JSX.Element) => {\n      pinInputFiledCounter++;\n      return React.cloneElement(\n        child,\n        {\n          fieldIndex: pinInputFiledCounter,\n        },\n        child.props.children\n      );\n    });\n  };\n\n  React.useEffect(() => {\n    if (value !== undefined && value != pinInputValue) setPinInputValue(value);\n  }, [value, pinInputValue, setPinInputValue]);\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  return (\n    <PinInputContext.Provider\n      value={{\n        ...formControlContext,\n        ...newProps,\n        setRefList,\n        handleChange,\n        handleMultiValueChange,\n        value: pinInputValue,\n      }}\n    >\n      {children && (\n        <HStack flexDirection=\"row\" space={space} {...padding} ref={ref}>\n          {indexSetter(children)}\n        </HStack>\n      )}\n    </PinInputContext.Provider>\n  );\n};\n\nexport default React.memo(React.forwardRef(PinInput));\n"]},"metadata":{},"sourceType":"module"}