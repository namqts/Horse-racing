{"ast":null,"code":"var aes=require(\"./aes\");var Buffer=require('safe-buffer').Buffer;var Transform=require('cipher-base');var inherits=require('inherits');var GHASH=require(\"./ghash\");var xor=require('buffer-xor');var incr32=require(\"./incr32\");function xorTest(a,b){var out=0;if(a.length!==b.length)out++;var len=Math.min(a.length,b.length);for(var i=0;i<len;++i){out+=a[i]^b[i];}return out;}function calcIv(self,iv,ck){if(iv.length===12){self._finID=Buffer.concat([iv,Buffer.from([0,0,0,1])]);return Buffer.concat([iv,Buffer.from([0,0,0,2])]);}var ghash=new GHASH(ck);var len=iv.length;var toPad=len%16;ghash.update(iv);if(toPad){toPad=16-toPad;ghash.update(Buffer.alloc(toPad,0));}ghash.update(Buffer.alloc(8,0));var ivBits=len*8;var tail=Buffer.alloc(8);tail.writeUIntBE(ivBits,0,8);ghash.update(tail);self._finID=ghash.state;var out=Buffer.from(self._finID);incr32(out);return out;}function StreamCipher(mode,key,iv,decrypt){Transform.call(this);var h=Buffer.alloc(4,0);this._cipher=new aes.AES(key);var ck=this._cipher.encryptBlock(h);this._ghash=new GHASH(ck);iv=calcIv(this,iv,ck);this._prev=Buffer.from(iv);this._cache=Buffer.allocUnsafe(0);this._secCache=Buffer.allocUnsafe(0);this._decrypt=decrypt;this._alen=0;this._len=0;this._mode=mode;this._authTag=null;this._called=false;}inherits(StreamCipher,Transform);StreamCipher.prototype._update=function(chunk){if(!this._called&&this._alen){var rump=16-this._alen%16;if(rump<16){rump=Buffer.alloc(rump,0);this._ghash.update(rump);}}this._called=true;var out=this._mode.encrypt(this,chunk);if(this._decrypt){this._ghash.update(chunk);}else{this._ghash.update(out);}this._len+=chunk.length;return out;};StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error('Unsupported state or unable to authenticate data');var tag=xor(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&xorTest(tag,this._authTag))throw new Error('Unsupported state or unable to authenticate data');this._authTag=tag;this._cipher.scrub();};StreamCipher.prototype.getAuthTag=function getAuthTag(){if(this._decrypt||!Buffer.isBuffer(this._authTag))throw new Error('Attempting to get auth tag in unsupported state');return this._authTag;};StreamCipher.prototype.setAuthTag=function setAuthTag(tag){if(!this._decrypt)throw new Error('Attempting to set auth tag in unsupported state');this._authTag=tag;};StreamCipher.prototype.setAAD=function setAAD(buf){if(this._called)throw new Error('Attempting to set AAD in unsupported state');this._ghash.update(buf);this._alen+=buf.length;};module.exports=StreamCipher;","map":{"version":3,"names":["aes","require","Buffer","Transform","inherits","GHASH","xor","incr32","xorTest","a","b","out","length","len","Math","min","i","calcIv","self","iv","ck","_finID","concat","from","ghash","toPad","update","alloc","ivBits","tail","writeUIntBE","state","StreamCipher","mode","key","decrypt","call","h","_cipher","AES","encryptBlock","_ghash","_prev","_cache","allocUnsafe","_secCache","_decrypt","_alen","_len","_mode","_authTag","_called","prototype","_update","chunk","rump","encrypt","_final","Error","tag","final","scrub","getAuthTag","isBuffer","setAuthTag","setAAD","buf","module","exports"],"sources":["C:/Users/Nam-QTS/AppData/Roaming/nvm/v14.18.1/node_modules/expo-cli/node_modules/browserify-aes/authCipher.js"],"sourcesContent":["var aes = require('./aes')\nvar Buffer = require('safe-buffer').Buffer\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\nvar incr32 = require('./incr32')\n\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) out++\n\n  var len = Math.min(a.length, b.length)\n  for (var i = 0; i < len; ++i) {\n    out += (a[i] ^ b[i])\n  }\n\n  return out\n}\n\nfunction calcIv (self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])])\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])])\n  }\n  var ghash = new GHASH(ck)\n  var len = iv.length\n  var toPad = len % 16\n  ghash.update(iv)\n  if (toPad) {\n    toPad = 16 - toPad\n    ghash.update(Buffer.alloc(toPad, 0))\n  }\n  ghash.update(Buffer.alloc(8, 0))\n  var ivBits = len * 8\n  var tail = Buffer.alloc(8)\n  tail.writeUIntBE(ivBits, 0, 8)\n  ghash.update(tail)\n  self._finID = ghash.state\n  var out = Buffer.from(self._finID)\n  incr32(out)\n  return out\n}\nfunction StreamCipher (mode, key, iv, decrypt) {\n  Transform.call(this)\n\n  var h = Buffer.alloc(4, 0)\n\n  this._cipher = new aes.AES(key)\n  var ck = this._cipher.encryptBlock(h)\n  this._ghash = new GHASH(ck)\n  iv = calcIv(this, iv, ck)\n\n  this._prev = Buffer.from(iv)\n  this._cache = Buffer.allocUnsafe(0)\n  this._secCache = Buffer.allocUnsafe(0)\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  this._mode = mode\n\n  this._authTag = null\n  this._called = false\n}\n\ninherits(StreamCipher, Transform)\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0)\n      this._ghash.update(rump)\n    }\n  }\n\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data')\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data')\n\n  this._authTag = tag\n  this._cipher.scrub()\n}\n\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state')\n\n  return this._authTag\n}\n\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state')\n\n  this._authTag = tag\n}\n\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state')\n\n  this._ghash.update(buf)\n  this._alen += buf.length\n}\n\nmodule.exports = StreamCipher\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}