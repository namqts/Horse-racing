{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"isHovered\",\"isFocused\",\"isFocusVisible\",\"variant\"],_excluded2=[\"onValueChange\",\"selectedValue\",\"children\",\"dropdownIcon\",\"dropdownCloseIcon\",\"dropdownOpenIcon\",\"placeholder\",\"accessibilityLabel\",\"defaultValue\",\"_item\",\"_selectedItem\",\"onOpen\",\"onClose\",\"optimized\",\"customDropdownIconProps\",\"_actionSheet\",\"_actionSheetContent\",\"_actionSheetBody\",\"_webSelect\"];function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React,{forwardRef,memo}from'react';import Platform from\"react-native-web/dist/exports/Platform\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import{Actionsheet}from\"../../composites/Actionsheet\";import Box from\"../Box\";import{Input}from\"../Input\";import{useFocusRing}from'@react-native-aria/focus';import{useControllableState}from\"../../../hooks\";import{usePropsResolution}from\"../../../hooks/useThemeProps\";import{useHover}from'@react-native-aria/interactions';import{mergeRefs}from\"../../../utils\";import{useFormControl}from\"../../composites/FormControl\";import{ChevronDownIcon}from\"../Icon/Icons\";import{ScrollView}from\"../../basic/ScrollView\";import{extractInObject,stylingProps}from\"../../../theme/tools/utils\";import{FlatList}from\"../../basic/FlatList\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";import{Pressable}from\"../Pressable\";export var SelectContext=React.createContext({onValueChange:function onValueChange(){},selectedValue:null,_selectedItem:{},_item:{}});var Select=function Select(_ref2,ref){var isHoveredProp=_ref2.isHovered,isFocusedProp=_ref2.isFocused,isFocusVisibleProp=_ref2.isFocusVisible,variant=_ref2.variant,props=_objectWithoutProperties(_ref2,_excluded);var selectProps=useFormControl({isDisabled:props.isDisabled,nativeID:props.nativeID});var flatListData=[];var isDisabled=selectProps.disabled;var tempFix='__NativebasePlaceholder__';var _ref=React.useRef(null);var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isOpen=_React$useState2[0],setIsOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isFocused=_React$useState4[0],setIsFocused=_React$useState4[1];var _useFocusRing=useFocusRing(),focusProps=_useFocusRing.focusProps,isFocusVisible=_useFocusRing.isFocusVisible;var _useHover=useHover({isDisabled:isDisabled},_ref),hoverProps=_useHover.hoverProps,isHovered=_useHover.isHovered;var _usePropsResolution=usePropsResolution('Select',props,{isDisabled:isDisabled,isHovered:isHoveredProp||isHovered,isFocused:isFocusedProp||isFocused,isFocusVisible:isFocusVisibleProp||isFocusVisible},undefined),onValueChange=_usePropsResolution.onValueChange,selectedValue=_usePropsResolution.selectedValue,children=_usePropsResolution.children,dropdownIcon=_usePropsResolution.dropdownIcon,dropdownCloseIcon=_usePropsResolution.dropdownCloseIcon,dropdownOpenIcon=_usePropsResolution.dropdownOpenIcon,placeholder=_usePropsResolution.placeholder,accessibilityLabel=_usePropsResolution.accessibilityLabel,defaultValue=_usePropsResolution.defaultValue,_item=_usePropsResolution._item,_selectedItem=_usePropsResolution._selectedItem,onOpen=_usePropsResolution.onOpen,onClose=_usePropsResolution.onClose,optimized=_usePropsResolution.optimized,customDropdownIconProps=_usePropsResolution.customDropdownIconProps,_actionSheet=_usePropsResolution._actionSheet,_actionSheetContent=_usePropsResolution._actionSheetContent,_actionSheetBody=_usePropsResolution._actionSheetBody,_webSelect=_usePropsResolution._webSelect,resolvedProps=_objectWithoutProperties(_usePropsResolution,_excluded2);var _useControllableState=useControllableState({value:selectedValue,defaultValue:defaultValue,onChange:function onChange(newValue){onValueChange&&onValueChange(newValue);setIsOpen(false);}}),_useControllableState2=_slicedToArray(_useControllableState,2),value=_useControllableState2[0],setValue=_useControllableState2[1];var itemsList=React.Children.toArray(children).map(function(child){var _child$props,_child$props2;return{label:child===null||child===void 0?void 0:(_child$props=child.props)===null||_child$props===void 0?void 0:_child$props.label,value:child===null||child===void 0?void 0:(_child$props2=child.props)===null||_child$props2===void 0?void 0:_child$props2.value};});var selectedItemArray=itemsList.filter(function(item){return(item===null||item===void 0?void 0:item.value)===value;});var selectedItem=selectedItemArray&&selectedItemArray.length?selectedItemArray[0]:null;var contextValue=React.useMemo(function(){return{onValueChange:setValue,selectedValue:value,_selectedItem:_selectedItem!==null&&_selectedItem!==void 0?_selectedItem:{},_item:_item!==null&&_item!==void 0?_item:{}};},[value,setValue,_selectedItem,_item]);if(useHasResponsiveProps(props)){return null;}var rightIcon=isOpen&&dropdownOpenIcon?dropdownOpenIcon:!isOpen&&dropdownCloseIcon?dropdownCloseIcon:dropdownIcon?dropdownIcon:React.createElement(ChevronDownIcon,customDropdownIconProps);var handleClose=function handleClose(){setIsOpen(false);onClose&&onClose();};if(optimized){React.Children.toArray(children).map(function(child){flatListData.push(child.props);});}var _extractInObject=extractInObject(resolvedProps,[].concat(_toConsumableArray(stylingProps.margin),_toConsumableArray(stylingProps.flexbox),_toConsumableArray(stylingProps.position),['shadow','opacity'])),_extractInObject2=_slicedToArray(_extractInObject,2),layoutProps=_extractInObject2[0],nonLayoutProps=_extractInObject2[1];var commonInput=React.createElement(Input,_extends({placeholder:placeholder,InputRightElement:rightIcon},nonLayoutProps,{isFocused:isFocused,isHovered:isHovered,\"aria-hidden\":true,importantForAccessibility:\"no\",value:selectedItem?selectedItem.label:'',editable:false,focusable:false,isDisabled:isDisabled,pointerEvents:\"none\",variant:variant}));return Platform.OS==='android'||Platform.OS==='ios'?React.createElement(React.Fragment,null,React.createElement(Pressable,_extends({onPress:function onPress(){Keyboard.dismiss();setIsOpen(true);onOpen&&onOpen();},disabled:isDisabled,accessibilityLabel:accessibilityLabel,accessibilityRole:\"button\",ref:mergeRefs([ref,_ref])},layoutProps),commonInput),React.createElement(Actionsheet,_extends({isOpen:isOpen,onClose:handleClose},_actionSheet),React.createElement(Actionsheet.Content,_actionSheetContent,optimized?React.createElement(FlatList,_extends({},_actionSheetBody,{data:flatListData,keyExtractor:function keyExtractor(_item,index){return index.toString();},renderItem:function renderItem(_ref3){var item=_ref3.item;var isSelected=selectedValue===(item===null||item===void 0?void 0:item.value);return React.createElement(Actionsheet.Item,_extends({onPress:function onPress(){if(!isDisabled){setValue(item===null||item===void 0?void 0:item.value);}},accessibilityState:{selected:isSelected}},item,_item,isSelected&&_selectedItem),item===null||item===void 0?void 0:item.label);}})):React.createElement(ScrollView,_actionSheetBody,React.createElement(SelectContext.Provider,{value:contextValue},children))))):React.createElement(Box,layoutProps,React.createElement(\"select\",_extends({\"aria-readonly\":selectProps.readOnly,required:selectProps.required,disabled:isDisabled},focusProps,hoverProps,{ref:mergeRefs([ref,_ref]),onChange:function onChange(e){setValue(e.target.value);},value:selectedItem===null?tempFix:value,\"aria-label\":placeholder,onFocus:function onFocus(){setIsFocused(true);onOpen&&onOpen();},onBlur:function onBlur(){setIsFocused(false);onClose&&onClose();}},_webSelect),React.createElement(\"option\",{disabled:true,value:tempFix},placeholder),children),commonInput);};export default memo(forwardRef(Select));","map":{"version":3,"sources":["Select.tsx"],"names":["React","forwardRef","memo","Actionsheet","Box","Input","useFocusRing","useControllableState","usePropsResolution","useHover","mergeRefs","useFormControl","ChevronDownIcon","ScrollView","extractInObject","stylingProps","FlatList","useHasResponsiveProps","Pressable","SelectContext","createContext","onValueChange","selectedValue","_selectedItem","_item","Select","isHovered","isHoveredProp","isFocused","isFocusedProp","isFocusVisible","isFocusVisibleProp","variant","props","ref","selectProps","isDisabled","nativeID","flatListData","disabled","tempFix","_ref","useRef","isOpen","setIsOpen","useState","setIsFocused","focusProps","hoverProps","children","dropdownIcon","dropdownCloseIcon","dropdownOpenIcon","placeholder","accessibilityLabel","defaultValue","onOpen","onClose","optimized","customDropdownIconProps","_actionSheet","_actionSheetContent","_actionSheetBody","_webSelect","resolvedProps","undefined","value","setValue","onChange","newValue","itemsList","Children","toArray","map","child","label","selectedItemArray","filter","item","selectedItem","length","contextValue","useMemo","rightIcon","handleClose","push","layoutProps","nonLayoutProps","margin","flexbox","position","commonInput","Platform","OS","Keyboard","dismiss","index","toString","isSelected","selected","readOnly","required","e","target"],"mappings":"+2BAAA,MAAOA,MAAP,EAAgBC,UAAhB,CAA4BC,IAA5B,KAAwC,OAAxC,CAAA,0HAGA,OAASC,WAAT,oCACA,MAAOC,IAAP,cACA,OAASC,KAAT,gBACA,OAASC,YAAT,KAA6B,0BAA7B,CACA,OAASC,oBAAT,sBACA,OAASC,kBAAT,oCACA,OAASC,QAAT,KAAyB,iCAAzB,CACA,OAASC,SAAT,sBACA,OAASC,cAAT,oCACA,OAASC,eAAT,qBAEA,OAASC,UAAT,8BACA,OAASC,eAAT,CAA0BC,YAA1B,kCACA,OAASC,QAAT,4BACA,OAASC,qBAAT,4CAEA,OAASC,SAAT,oBAEA,MAAO,IAAMC,cAAa,CAAG,KAAK,CAACC,aAAN,CAAoB,CAC/CC,aAAa,CAAG,wBAAM,CAAE,CADuB,CAE/CC,aAAa,CAAE,IAFgC,CAG/CC,aAAa,CAAE,CAAA,CAHgC,CAI/CC,KAAK,CAAE,CAAA,CAJwC,CAApB,CAAtB,CAOP,GAAMC,OAAM,CAAG,QAATA,OAAM,OAQVS,GARa,CASV,IAPUP,cADb,OACED,SAAS,CACEG,aAFb,OAEED,SAAS,CACOG,kBAHlB,OAGED,cAAc,CACdE,OAJF,OAIEA,OAJF,CAKKC,KAAAA,2CAIL,GAAME,YAAW,CAAGxB,cAAc,CAAC,CACjCyB,UAAU,CAAEH,KAAK,CAACG,UADe,CAEjCC,QAAQ,CAAEJ,KAAK,CAACI,QAFiB,CAAD,CAAlC,CAIA,GAAMC,aAAgC,CAAG,EAAzC,CAEA,GAAMF,WAAU,CAAGD,WAAW,CAACI,QAA/B,CACA,GAAMC,QAAO,CAAG,2BAAhB,CACA,GAAMC,KAAI,CAAGzC,KAAK,CAAC0C,MAAN1C,CAAa,IAAbA,CAAb,CAEA,oBAA4BA,KAAK,CAAC6C,QAAN7C,CAAwB,KAAxBA,CAA5B,oDAAO2C,MAAD,qBAASC,SAAT,qBACN,qBAAkC5C,KAAK,CAAC6C,QAAN7C,CAAwB,KAAxBA,CAAlC,qDAAO4B,SAAD,qBAAYkB,YAAZ,qBAEN,kBAAuCxC,YAAY,EAAnD,CAAQyC,UAAF,eAAEA,UAAF,CAAcjB,cAAAA,eAAAA,cAAAA,CACpB,cAAkCrB,QAAQ,CAAC,CAAE2B,UAAAA,CAAAA,UAAF,CAAD,CAAiBK,IAAjB,CAA1C,CAAQO,UAAF,WAAEA,UAAF,CAActB,SAAAA,WAAAA,SAAAA,CAEpB,wBAqBIlB,kBAAkB,CACpB,QADoB,CAEpByB,KAFoB,CAGpB,CACEG,UADF,CACEA,UADF,CAEEV,SAAS,CAAEC,aAAa,EAAID,SAF9B,CAGEE,SAAS,CAAEC,aAAa,EAAID,SAH9B,CAIEE,cAAc,CAAEC,kBAAkB,EAAID,cAJxC,CAHoB,CASpBmC,SAToB,CArBtB,CACE5C,aADI,qBACJA,aADI,CAEJC,aAFI,qBAEJA,aAFI,CAGJ2B,QAHI,qBAGJA,QAHI,CAIJC,YAJI,qBAIJA,YAJI,CAKJC,iBALI,qBAKJA,iBALI,CAMJC,gBANI,qBAMJA,gBANI,CAOJC,WAPI,qBAOJA,WAPI,CAQJC,kBARI,qBAQJA,kBARI,CASJC,YATI,qBASJA,YATI,CAUJ/B,KAVI,qBAUJA,KAVI,CAWJD,aAXI,qBAWJA,aAXI,CAYJiC,MAZI,qBAYJA,MAZI,CAaJC,OAbI,qBAaJA,OAbI,CAcJC,SAdI,qBAcJA,SAdI,CAeJC,uBAfI,qBAeJA,uBAfI,CAgBJC,YAhBI,qBAgBJA,YAhBI,CAiBJC,mBAjBI,qBAiBJA,mBAjBI,CAkBJC,gBAlBI,qBAkBJA,gBAlBI,CAmBJC,UAnBI,qBAmBJA,UAnBI,CAoBDC,aAAAA,0DAaL,0BAA0BzD,oBAAoB,CAAC,CAC7C2D,KAAK,CAAE5C,aADsC,CAE7CiC,YAF6C,CAE7CA,YAF6C,CAG7Ca,QAAQ,CAAGC,kBAAAA,QAAD,CAAc,CACtBhD,aAAa,EAAIA,aAAa,CAACgD,QAAD,CAA9BhD,CACAuB,SAAS,CAAC,KAAD,CAATA,CACD,CAN4C,CAAD,CAA9C,gEAAOsB,KAAD,2BAAQC,QAAR,2BASN,GAAMG,UAGJ,CAAG,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBvB,QAAvB,CAAA,CAAiCwB,GAAjC,CAAsCC,SAAAA,KAAD,CAAgB,CAAA,GAAA,aAAA,CAAA,aAAA,CACxD,MAAO,CACLC,KAAK,CAAED,KAAF,GAAA,IAAA,EAAEA,KAAF,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAA,CAAA,YAAA,CAAEA,KAAK,CAAEzC,KAAT,IAAA,IAAA,EAAA,YAAA,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAEyC,YAAAA,CAAcC,KADhB,CAELT,KAAK,CAAEQ,KAAF,GAAA,IAAA,EAAEA,KAAF,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAA,CAAA,aAAA,CAAEA,KAAK,CAAEzC,KAAT,IAAA,IAAA,EAAA,aAAA,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAEyC,aAAAA,CAAcR,KAFhB,CAAP,CAID,CALI,CAHL,CAUA,GAAMU,kBAAiB,CAAGN,SAAS,CAACO,MAAVP,CACvBQ,SAAAA,IAAD,QAAe,CAAA,IAAI,GAAA,IAAJ,EAAA,IAAI,GAAA,IAAA,EAAJ,CAAA,IAAA,EAAA,CAAA,IAAI,CAAEZ,KAAN,IAAgBA,KADPI,GAA1B,CAIA,GAAMS,aAAY,CAChBH,iBAAiB,EAAIA,iBAAiB,CAACI,MAAvCJ,CAAgDA,iBAAiB,CAAC,CAAD,CAAjEA,CAAuE,IADzE,CAGA,GAAMK,aAAY,CAAG,KAAK,CAACC,OAAN,CAAc,UAAM,CACvC,MAAO,CACL7D,aAAa,CAAE8C,QADV,CAEL7C,aAAa,CAAE4C,KAFV,CAGL3C,aAAa,CAAEA,aAAF,GAAA,IAAA,EAAEA,aAAF,GAAA,IAAA,EAAA,CAAEA,aAAF,CAAmB,CAAA,CAH3B,CAILC,KAAK,CAAEA,KAAF,GAAA,IAAA,EAAEA,KAAF,GAAA,IAAA,EAAA,CAAEA,KAAF,CAAW,CAAA,CAJX,CAAP,CAMD,CAPoB,CAOlB,CAAC0C,KAAD,CAAQC,QAAR,CAAkB5C,aAAlB,CAAiCC,KAAjC,CAPkB,CA5ElB,CAsFH,GAAIP,qBAAqB,CAACgB,KAAD,CAAzB,CAAkC,CAChC,MAAO,KAAP,CACD,CAED,GAAMkD,UAAS,CACbxC,MAAM,EAAIS,gBAAVT,CACES,gBADFT,CAEI,CAACA,MAAD,EAAWQ,iBAAX,CACFA,iBADE,CAEAD,YAAY,CACdA,YADc,CAGd,KAAA,CAAA,aAAA,CAAC,eAAD,CAAqBS,uBAArB,CARJ,CAWA,GAAMyB,YAAW,CAAG,QAAdA,YAAW,EAAS,CACxBxC,SAAS,CAAC,KAAD,CAATA,CACAa,OAAO,EAAIA,OAAO,EAAlBA,CACD,CAHD,CAKA,GAAIC,SAAJ,CAAe,CACb1D,KAAK,CAACuE,QAANvE,CAAewE,OAAfxE,CAAuBiD,QAAvBjD,CAAAA,CAAiCyE,GAAjCzE,CAAsC0E,SAAAA,KAAD,CAAgB,CACnDpC,YAAY,CAAC+C,IAAb/C,CAAkBoC,KAAK,CAACzC,KAAxBK,CAAAA,CACD,CAFDtC,CAAAA,CAGD,CAED,qBAAsCc,eAAe,CAACkD,aAAD,8BAChDjD,YAAY,CAACyE,MADmD,qBAEhEzE,YAAY,CAAC0E,OAFmD,qBAGhE1E,YAAY,CAAC2E,QAHmD,GAInE,QAJmE,CAKnE,SALmD,GAArD,sDAAOJ,WAAD,sBAAcC,cAAd,sBAQN,GAAMI,YAAW,CACf,KAAA,CAAA,aAAA,CAAC,KAAD,CAAA,QAAA,CAAA,CACE,WAAW,CAAEtC,WADf,CAEE,iBAAiB,CAAE8B,SAFrB,CAAA,CAGMI,cAHN,CAAA,CAME,SAAS,CAAE3D,SANb,CAOE,SAAS,CAAEF,SAPb,CAQE,aAAA,CAAa,IARf,CASE,yBAAyB,CAAC,IAT5B,CAUE,KAAK,CAAEqD,YAAY,CAAGA,YAAY,CAACJ,KAAhB,CAAwB,EAV7C,CAWE,QAAQ,CAAE,KAXZ,CAYE,SAAS,CAAE,KAZb,CAaE,UAAU,CAAEvC,UAbd,CAcE,aAAa,CAAC,MAdhB,CAeE,OAAO,CAAEJ,OAfX,CAAA,CAAA,CADF,CAoBA,MAAO4D,SAAQ,CAACC,EAATD,GAAgB,SAAhBA,EAA6BA,QAAQ,CAACC,EAATD,GAAgB,KAA7CA,CACL,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CACE,KAAA,CAAA,aAAA,CAAC,SAAD,CAAA,QAAA,CAAA,CACE,OAAO,CAAE,kBAAM,CACbE,QAAQ,CAACC,OAATD,EAAAA,CACAlD,SAAS,CAAC,IAAD,CAATA,CACAY,MAAM,EAAIA,MAAM,EAAhBA,CACD,CALH,CAME,QAAQ,CAAEpB,UANZ,CAOE,kBAAkB,CAAEkB,kBAPtB,CAQE,iBAAiB,CAAC,QARpB,CASE,GAAG,CAAE5C,SAAS,CAAC,CAACwB,GAAD,CAAMO,IAAN,CAAD,CAThB,CAAA,CAUM6C,WAVN,CAAA,CAYGK,WAZH,CADF,CAeE,KAAA,CAAA,aAAA,CAAC,WAAD,CAAA,QAAA,CAAA,CAAa,MAAM,CAAEhD,MAArB,CAA6B,OAAO,CAAEyC,WAAtC,CAAA,CAAuDxB,YAAvD,CAAA,CACE,KAAA,CAAA,aAAA,CAAC,WAAD,CAAa,OAAb,CAAyBC,mBAAzB,CAEGH,SAAS,CACR,KAAA,CAAA,aAAA,CAAC,QAAD,CAAA,QAAA,CAAA,CAAA,CAAA,CACMI,gBADN,CAAA,CAEE,IAAI,CAAExB,YAFR,CAIE,YAAY,CAAE,sBAACd,KAAD,CAAQwE,KAAR,QAAkBA,MAAK,CAACC,QAAND,EAJlC,GAKE,UAAU,CAAE,0BAAmB,IAAhBlB,KAAAA,OAAAA,IAAAA,CACb,GAAMoB,WAAU,CAAG5E,aAAa,IAAKwD,IAAL,GAAA,IAAA,EAAKA,IAAL,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAKA,IAAI,CAAEZ,KAAX,CAAhC,CACA,MACE,MAAA,CAAA,aAAA,CAAC,WAAD,CAAa,IAAb,CAAA,QAAA,CAAA,CACE,OAAO,CAAE,kBAAM,CACb,GAAI,CAAC9B,UAAL,CAAiB,CACf+B,QAAQ,CAACW,IAAD,GAAA,IAAA,EAACA,IAAD,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAACA,IAAI,CAAEZ,KAAP,CAARC,CACD,CACF,CALH,CAME,kBAAkB,CAAE,CAAEgC,QAAQ,CAAED,UAAZ,CANtB,CAAA,CAOMpB,IAPN,CAQMtD,KARN,CASO0E,UAAU,EAAI3E,aATrB,CAAA,CAWGuD,IAXH,GAAA,IAAA,EAWGA,IAXH,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAWGA,IAAI,CAAEH,KAXT,CADF,CAeD,CAtBH,CAAA,CAAA,CADQ,CA0BR,KAAA,CAAA,aAAA,CAAC,UAAD,CAAgBb,gBAAhB,CACE,KAAA,CAAA,aAAA,CAAC,aAAD,CAAe,QAAf,CAAA,CAAwB,KAAK,CAAEmB,YAA/B,CAAA,CACGhC,QADH,CADF,CA5BJ,CADF,CAfF,CADK2C,CAuDL,KAAA,CAAA,aAAA,CAAC,GAAD,CAASN,WAAT,CAEE,KAAA,CAAA,aAAA,CAAA,QAAA,CAAA,QAAA,CAAA,CACE,eAAA,CAAenD,WAAW,CAACiE,QAD7B,CAEE,QAAQ,CAAEjE,WAAW,CAACkE,QAFxB,CAGE,QAAQ,CAAEjE,UAHZ,CAAA,CAIMW,UAJN,CAKMC,UALN,CAAA,CAME,GAAG,CAAEtC,SAAS,CAAC,CAACwB,GAAD,CAAMO,IAAN,CAAD,CANhB,CAQE,QAAQ,CAAG6D,kBAAAA,CAAD,CAAO,CACfnC,QAAQ,CAACmC,CAAC,CAACC,MAAFD,CAASpC,KAAV,CAARC,CACD,CAVH,CAWE,KAAK,CAAEY,YAAY,GAAK,IAAjBA,CAAwBvC,OAAxBuC,CAAkCb,KAX3C,CAYE,YAAA,CAAYb,WAZd,CAaE,OAAO,CAAE,kBAAM,CACbP,YAAY,CAAC,IAAD,CAAZA,CACAU,MAAM,EAAIA,MAAM,EAAhBA,CACD,CAhBH,CAiBE,MAAM,CAAE,iBAAM,CACZV,YAAY,CAAC,KAAD,CAAZA,CACAW,OAAO,EAAIA,OAAO,EAAlBA,CACD,CApBH,CAAA,CAqBMM,UArBN,CAAA,CAuBE,KAAA,CAAA,aAAA,CAAA,QAAA,CAAA,CAAQ,QAAQ,CAAA,IAAhB,CAAiB,KAAK,CAAEvB,OAAxB,CAAA,CACGa,WADH,CAvBF,CA0BGJ,QA1BH,CAFF,CA+BG0C,WA/BH,CAvDF,CAyFD,CA9OD,CAgPA,cAAezF,KAAI,CAACD,UAAU,CAACwB,MAAD,CAAX,CAAnB","sourcesContent":["import React, { forwardRef, memo } from 'react';\nimport type { ISelectProps } from './types';\nimport { Platform, Keyboard } from 'react-native';\nimport { Actionsheet } from '../../composites/Actionsheet';\nimport Box from '../Box';\nimport { Input } from '../Input';\nimport { useFocusRing } from '@react-native-aria/focus';\nimport { useControllableState } from '../../../hooks';\nimport { usePropsResolution } from '../../../hooks/useThemeProps';\nimport { useHover } from '@react-native-aria/interactions';\nimport { mergeRefs } from '../../../utils';\nimport { useFormControl } from '../../composites/FormControl';\nimport { ChevronDownIcon } from '../Icon/Icons';\nimport type { IButtonProps } from '../Button/types';\nimport { ScrollView } from '../../basic/ScrollView';\nimport { extractInObject, stylingProps } from '../../../theme/tools/utils';\nimport { FlatList } from '../../basic/FlatList';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\nimport type { ISelectItemProps } from './types';\nimport { Pressable } from '../Pressable';\n\nexport const SelectContext = React.createContext({\n  onValueChange: (() => {}) as any,\n  selectedValue: null as any,\n  _selectedItem: {} as IButtonProps,\n  _item: {} as IButtonProps,\n});\n\nconst Select = (\n  {\n    isHovered: isHoveredProp,\n    isFocused: isFocusedProp,\n    isFocusVisible: isFocusVisibleProp,\n    variant,\n    ...props\n  }: ISelectProps,\n  ref: any\n) => {\n  const selectProps = useFormControl({\n    isDisabled: props.isDisabled,\n    nativeID: props.nativeID,\n  });\n  const flatListData: ISelectItemProps[] = [];\n\n  const isDisabled = selectProps.disabled;\n  const tempFix = '__NativebasePlaceholder__';\n  const _ref = React.useRef(null);\n\n  const [isOpen, setIsOpen] = React.useState<boolean>(false);\n  const [isFocused, setIsFocused] = React.useState<boolean>(false);\n\n  const { focusProps, isFocusVisible } = useFocusRing();\n  const { hoverProps, isHovered } = useHover({ isDisabled }, _ref);\n\n  const {\n    onValueChange,\n    selectedValue,\n    children,\n    dropdownIcon,\n    dropdownCloseIcon,\n    dropdownOpenIcon,\n    placeholder,\n    accessibilityLabel,\n    defaultValue,\n    _item,\n    _selectedItem,\n    onOpen,\n    onClose,\n    optimized,\n    customDropdownIconProps,\n    _actionSheet,\n    _actionSheetContent,\n    _actionSheetBody,\n    _webSelect,\n    ...resolvedProps\n  } = usePropsResolution(\n    'Select',\n    props,\n    {\n      isDisabled,\n      isHovered: isHoveredProp || isHovered,\n      isFocused: isFocusedProp || isFocused,\n      isFocusVisible: isFocusVisibleProp || isFocusVisible,\n    },\n    undefined\n  );\n\n  const [value, setValue] = useControllableState({\n    value: selectedValue,\n    defaultValue,\n    onChange: (newValue) => {\n      onValueChange && onValueChange(newValue);\n      setIsOpen(false);\n    },\n  });\n\n  const itemsList: Array<{\n    label: string;\n    value: string;\n  }> = React.Children.toArray(children).map((child: any) => {\n    return {\n      label: child?.props?.label,\n      value: child?.props?.value,\n    };\n  });\n\n  const selectedItemArray = itemsList.filter(\n    (item: any) => item?.value === value\n  );\n\n  const selectedItem =\n    selectedItemArray && selectedItemArray.length ? selectedItemArray[0] : null;\n\n  const contextValue = React.useMemo(() => {\n    return {\n      onValueChange: setValue,\n      selectedValue: value,\n      _selectedItem: _selectedItem ?? {},\n      _item: _item ?? {},\n    };\n  }, [value, setValue, _selectedItem, _item]);\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  const rightIcon =\n    isOpen && dropdownOpenIcon ? (\n      dropdownOpenIcon\n    ) : !isOpen && dropdownCloseIcon ? (\n      dropdownCloseIcon\n    ) : dropdownIcon ? (\n      dropdownIcon\n    ) : (\n      <ChevronDownIcon {...customDropdownIconProps} />\n    );\n\n  const handleClose = () => {\n    setIsOpen(false);\n    onClose && onClose();\n  };\n\n  if (optimized) {\n    React.Children.toArray(children).map((child: any) => {\n      flatListData.push(child.props);\n    });\n  }\n\n  const [layoutProps, nonLayoutProps] = extractInObject(resolvedProps, [\n    ...stylingProps.margin,\n    ...stylingProps.flexbox,\n    ...stylingProps.position,\n    'shadow',\n    'opacity',\n  ]);\n\n  const commonInput = (\n    <Input\n      placeholder={placeholder}\n      InputRightElement={rightIcon}\n      {...nonLayoutProps}\n      // NOTE: Adding ts-ignore as we're not exposing isFocused in the Input component\n      // @ts-ignore-next-line\n      isFocused={isFocused}\n      isHovered={isHovered}\n      aria-hidden={true}\n      importantForAccessibility=\"no\"\n      value={selectedItem ? selectedItem.label : ''}\n      editable={false}\n      focusable={false}\n      isDisabled={isDisabled}\n      pointerEvents=\"none\"\n      variant={variant}\n    />\n  );\n\n  return Platform.OS === 'android' || Platform.OS === 'ios' ? (\n    <>\n      <Pressable\n        onPress={() => {\n          Keyboard.dismiss();\n          setIsOpen(true);\n          onOpen && onOpen();\n        }}\n        disabled={isDisabled}\n        accessibilityLabel={accessibilityLabel}\n        accessibilityRole=\"button\"\n        ref={mergeRefs([ref, _ref])}\n        {...layoutProps}\n      >\n        {commonInput}\n      </Pressable>\n      <Actionsheet isOpen={isOpen} onClose={handleClose} {..._actionSheet}>\n        <Actionsheet.Content {..._actionSheetContent}>\n          {/* TODO: Replace ScrollVeiw with FlatList */}\n          {optimized ? (\n            <FlatList\n              {..._actionSheetBody}\n              data={flatListData}\n              // eslint-disable-next-line no-shadow\n              keyExtractor={(_item, index) => index.toString()}\n              renderItem={({ item }: any) => {\n                const isSelected = selectedValue === item?.value;\n                return (\n                  <Actionsheet.Item\n                    onPress={() => {\n                      if (!isDisabled) {\n                        setValue(item?.value);\n                      }\n                    }}\n                    accessibilityState={{ selected: isSelected }}\n                    {...item}\n                    {..._item}\n                    {...(isSelected && _selectedItem)}\n                  >\n                    {item?.label}\n                  </Actionsheet.Item>\n                );\n              }}\n            />\n          ) : (\n            <ScrollView {..._actionSheetBody}>\n              <SelectContext.Provider value={contextValue}>\n                {children}\n              </SelectContext.Provider>\n            </ScrollView>\n          )}\n        </Actionsheet.Content>\n      </Actionsheet>\n    </>\n  ) : (\n    <Box {...layoutProps}>\n      {/* <Box w=\"100%\" h=\"100%\" position=\"absolute\" opacity=\"0\" zIndex={1}> */}\n      <select\n        aria-readonly={selectProps.readOnly}\n        required={selectProps.required}\n        disabled={isDisabled}\n        {...focusProps}\n        {...hoverProps}\n        ref={mergeRefs([ref, _ref])}\n        //@ts-ignore\n        onChange={(e) => {\n          setValue(e.target.value);\n        }}\n        value={selectedItem === null ? tempFix : value}\n        aria-label={placeholder}\n        onFocus={() => {\n          setIsFocused(true);\n          onOpen && onOpen();\n        }}\n        onBlur={() => {\n          setIsFocused(false);\n          onClose && onClose();\n        }}\n        {..._webSelect}\n      >\n        <option disabled value={tempFix}>\n          {placeholder}\n        </option>\n        {children}\n      </select>\n      {/* </Box> */}\n      {commonInput}\n    </Box>\n  );\n};\n\nexport default memo(forwardRef(Select));\n"]},"metadata":{},"sourceType":"module"}