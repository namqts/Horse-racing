{"ast":null,"code":"import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"hideDragIndicator\",\"children\",\"handleClose\",\"pan\",\"sheetHeight\"],_excluded2=[\"_dragIndicator\",\"_dragIndicatorWrapperOffSet\",\"_dragIndicatorWrapper\"],_excluded3=[\"children\"];function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React,{memo,forwardRef}from'react';import{Modal}from\"../../composites/Modal\";import{usePropsResolution}from\"../../../hooks\";import Animated from\"react-native-web/dist/exports/Animated\";import PanResponder from\"react-native-web/dist/exports/PanResponder\";import{ModalContext}from\"../Modal/Context\";import Box from\"../../primitives/Box\";import{ActionSheetContext}from\"./ActionSheetContext\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";var Content=memo(forwardRef(function(_ref,ref){var hideDragIndicator=_ref.hideDragIndicator,children=_ref.children,handleClose=_ref.handleClose,pan=_ref.pan,sheetHeight=_ref.sheetHeight,props=_objectWithoutProperties(_ref,_excluded);var _usePropsResolution=usePropsResolution('ActionsheetContent',props),_dragIndicator=_usePropsResolution._dragIndicator,_dragIndicatorWrapperOffSet=_usePropsResolution._dragIndicatorWrapperOffSet,_dragIndicatorWrapper=_usePropsResolution._dragIndicatorWrapper,resolvedProps=_objectWithoutProperties(_usePropsResolution,_excluded2);var handleCloseRef=React.useRef(null);var handleCloseCallback=React.useCallback(function(){var handleCloseCurrent=handleCloseRef.current;return handleCloseCurrent();},[]);React.useEffect(function(){handleCloseRef.current=handleClose;},[handleClose]);var panResponder=React.useRef(PanResponder.create({onStartShouldSetPanResponder:function onStartShouldSetPanResponder(){return true;},onMoveShouldSetPanResponder:function onMoveShouldSetPanResponder(_evt,gestureState){return gestureState.dy>15;},onPanResponderMove:function onPanResponderMove(e,gestureState){if(gestureState.dy>0){Animated.event([null,{dy:pan.y}],{useNativeDriver:false})(e,gestureState);}},onPanResponderRelease:function onPanResponderRelease(_e,gestureState){if(sheetHeight.current/4-gestureState.dy<0){Animated.timing(pan,{toValue:{x:0,y:sheetHeight.current},duration:150,useNativeDriver:true}).start(handleCloseCallback);setTimeout(function(){Animated.timing(pan,{toValue:{x:0,y:0},duration:150,useNativeDriver:true}).start();},300);}else{Animated.spring(pan,{toValue:{x:0,y:0},overshootClamping:true,useNativeDriver:true}).start();}}})).current;return React.createElement(React.Fragment,null,!hideDragIndicator?React.createElement(React.Fragment,null,React.createElement(Box,_extends({},panResponder.panHandlers,_dragIndicatorWrapperOffSet))):null,React.createElement(Modal.Content,_extends({},resolvedProps,{ref:ref,safeAreaBottom:true}),!hideDragIndicator?React.createElement(React.Fragment,null,React.createElement(Box,_extends({},panResponder.panHandlers,_dragIndicatorWrapper),React.createElement(Box,_dragIndicator))):null,children));}));var ActionsheetContent=function ActionsheetContent(_ref2,ref){var children=_ref2.children,props=_objectWithoutProperties(_ref2,_excluded3);var _React$useContext=React.useContext(ModalContext),handleClose=_React$useContext.handleClose;var _React$useContext2=React.useContext(ActionSheetContext),hideDragIndicator=_React$useContext2.hideDragIndicator;var pan=React.useRef(new Animated.ValueXY()).current;var sheetHeight=React.useRef(0);var handleCloseCallback=React.useCallback(handleClose,[ModalContext,handleClose]);if(useHasResponsiveProps(props)){return null;}return React.createElement(Animated.View,{style:{transform:[{translateY:pan.y}],width:'100%'},onLayout:function onLayout(event){var height=event.nativeEvent.layout.height;sheetHeight.current=height;},pointerEvents:\"box-none\"},React.createElement(Content,_extends({children:children,sheetHeight:sheetHeight,pan:pan,hideDragIndicator:hideDragIndicator,handleClose:handleCloseCallback,ref:ref},props)));};export default memo(forwardRef(ActionsheetContent));","map":{"version":3,"sources":["ActionsheetContent.tsx"],"names":["React","memo","forwardRef","Modal","usePropsResolution","ModalContext","Box","ActionSheetContext","useHasResponsiveProps","Content","hideDragIndicator","children","handleClose","pan","sheetHeight","props","ref","_dragIndicator","_dragIndicatorWrapperOffSet","_dragIndicatorWrapper","resolvedProps","handleCloseRef","useRef","handleCloseCallback","useCallback","handleCloseCurrent","current","useEffect","panResponder","create","onStartShouldSetPanResponder","onMoveShouldSetPanResponder","_evt","gestureState","dy","onPanResponderMove","e","Animated","event","y","useNativeDriver","onPanResponderRelease","_e","timing","toValue","x","duration","start","setTimeout","spring","overshootClamping","panHandlers","ActionsheetContent","useContext","ValueXY","transform","translateY","width","height","nativeEvent","layout"],"mappings":"yiBAAA,MAAOA,MAAP,EAAgBC,IAAhB,CAAsBC,UAAtB,KAAwC,OAAxC,CACA,OAASC,KAAT,8BAEA,OAASC,kBAAT,sBAAA,kIAEA,OAASC,YAAT,wBACA,MAAOC,IAAP,4BACA,OAASC,kBAAT,4BACA,OAASC,qBAAT,4CAEA,GAAMC,QAAO,CAAGR,IAAI,CAClBC,UAAU,CACR,cASEc,GATF,CAUK,IARDN,kBADF,MACEA,iBADF,CAEEC,QAFF,MAEEA,QAFF,CAGEC,WAHF,MAGEA,WAHF,CAIEC,GAJF,MAIEA,GAJF,CAKEC,WALF,MAKEA,WALF,CAMKC,KAAAA,0CAIL,wBAKIX,kBAAkB,CAAC,oBAAD,CAAuBW,KAAvB,CALtB,CACEE,cADI,qBACJA,cADI,CAEJC,2BAFI,qBAEJA,2BAFI,CAGJC,qBAHI,qBAGJA,qBAHI,CAIDC,aAAAA,0DAGL,GAAMC,eAAc,CAAGrB,KAAK,CAACsB,MAANtB,CAAa,IAAbA,CAAvB,CACA,GAAMuB,oBAAmB,CAAG,KAAK,CAACC,WAAN,CAAkB,UAAM,CAClD,GAAIC,mBAAkB,CAAGJ,cAAc,CAACK,OADU,CAGlD,MAAOD,mBAAkB,EAAzB,CACD,CAJ2B,CAIzB,EAJyB,CAA5B,CAKAzB,KAAK,CAAC2B,SAAN3B,CAAgB,UAAM,CACpBqB,cAAc,CAACK,OAAfL,CAAyBT,WAAzBS,CACD,CAFDrB,CAEG,CAACY,WAAD,CAFHZ,CAAAA,CAIA,GAAM4B,aAAY,CAAG,KAAK,CAACN,MAAN,CACnB,YAAY,CAACO,MAAb,CAAoB,CAClBC,4BAA4B,CAAE,8CAAM,KADlB,GAElBC,2BAA2B,CAAE,qCAACC,IAAD,CAAOC,YAAP,CAAwB,CACnD,MAAOA,aAAY,CAACC,EAAbD,CAAkB,EAAzB,CACD,CAJiB,CAKlBE,kBAAkB,CAAE,4BAACC,CAAD,CAAIH,YAAJ,CAAqB,CACvC,GAAIA,YAAY,CAACC,EAAbD,CAAkB,CAAtB,CAAyB,CACvBI,QAAQ,CAACC,KAATD,CAAe,CAAC,IAAD,CAAO,CAAEH,EAAE,CAAErB,GAAG,CAAC0B,CAAV,CAAP,CAAfF,CAAsC,CACpCG,eAAe,CAAE,KADmB,CAAtCH,CAAAA,CAEGD,CAFHC,CAEMJ,YAFNI,CAAAA,CAGD,CACF,CAXiB,CAYlBI,qBAAqB,CAAE,+BAACC,EAAD,CAAKT,YAAL,CAAsB,CAE3C,GAAInB,WAAW,CAACY,OAAZZ,CAAsB,CAAtBA,CAA0BmB,YAAY,CAACC,EAAvCpB,CAA4C,CAAhD,CAAmD,CACjDuB,QAAQ,CAACM,MAATN,CAAgBxB,GAAhBwB,CAAqB,CACnBO,OAAO,CAAE,CAAEC,CAAC,CAAE,CAAL,CAAQN,CAAC,CAAEzB,WAAW,CAACY,OAAvB,CADU,CAEnBoB,QAAQ,CAAE,GAFS,CAGnBN,eAAe,CAAE,IAHE,CAArBH,CAAAA,CAIGU,KAJHV,CAISd,mBAJTc,CAAAA,CAMAW,UAAU,CAAC,UAAM,CACfX,QAAQ,CAACM,MAATN,CAAgBxB,GAAhBwB,CAAqB,CACnBO,OAAO,CAAE,CAAEC,CAAC,CAAE,CAAL,CAAQN,CAAC,CAAE,CAAX,CADU,CAEnBO,QAAQ,CAAE,GAFS,CAGnBN,eAAe,CAAE,IAHE,CAArBH,CAAAA,CAIGU,KAJHV,EAAAA,CAKD,CANS,CAMP,GANO,CAAVW,CAOD,CAdD,IAcO,CACLX,QAAQ,CAACY,MAATZ,CAAgBxB,GAAhBwB,CAAqB,CACnBO,OAAO,CAAE,CAAEC,CAAC,CAAE,CAAL,CAAQN,CAAC,CAAE,CAAX,CADU,CAEnBW,iBAAiB,CAAE,IAFA,CAGnBV,eAAe,CAAE,IAHE,CAArBH,CAAAA,CAIGU,KAJHV,EAAAA,CAKD,CACF,CAnCiB,CAApB,CADmB,CAAA,CAsCnBX,OAtCF,CAwCA,MACE,MAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CACG,CAAChB,iBAAD,CACC,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CAEE,KAAA,CAAA,aAAA,CAAC,GAAD,CAAA,QAAA,CAAA,CAAA,CAAA,CACMkB,YAAY,CAACuB,WADnB,CAEMjC,2BAFN,CAAA,CAFF,CADD,CAQG,IATN,CAWE,KAAA,CAAA,aAAA,CAAC,KAAD,CAAO,OAAP,CAAA,QAAA,CAAA,CAAA,CAAA,CAAmBE,aAAnB,CAAA,CAAkC,GAAG,CAAEJ,GAAvC,CAA4C,cAAc,CAAA,IAA1D,CAAA,CAAA,CACG,CAACN,iBAAD,CACC,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CAEE,KAAA,CAAA,aAAA,CAAC,GAAD,CAAA,QAAA,CAAA,CAAA,CAAA,CAASkB,YAAY,CAACuB,WAAtB,CAAuChC,qBAAvC,CAAA,CACE,KAAA,CAAA,aAAA,CAAC,GAAD,CAASF,cAAT,CADF,CAFF,CADD,CAOG,IARN,CAUGN,QAVH,CAXF,CADF,CA0BD,CA/FO,CADQ,CAApB,CAmGA,GAAMyC,mBAAkB,CAAG,QAArBA,mBAAkB,OAEtBpC,GAFyB,CAGtB,IAFDL,SAAF,OAAEA,QAAF,CAAeI,KAAAA,4CAIf,sBAAwBf,KAAK,CAACqD,UAANrD,CAAiBK,YAAjBL,CAAxB,CAAQY,WAAAA,mBAAAA,WAAAA,CACR,uBAA8BZ,KAAK,CAACqD,UAANrD,CAAiBO,kBAAjBP,CAA9B,CAAQU,iBAAAA,oBAAAA,iBAAAA,CACR,GAAMG,IAAG,CAAGb,KAAK,CAACsB,MAANtB,CAAa,GAAIqC,SAAQ,CAACiB,OAAb,EAAbtD,CAAAA,CAAqC0B,OAAjD,CACA,GAAMZ,YAAW,CAAGd,KAAK,CAACsB,MAANtB,CAAa,CAAbA,CAApB,CAEA,GAAMuB,oBAAmB,CAAGvB,KAAK,CAACwB,WAANxB,CAAkBY,WAAlBZ,CAA+B,CACzDK,YADyD,CAEzDO,WAFyD,CAA/BZ,CAPzB,CAiBH,GAAIQ,qBAAqB,CAACO,KAAD,CAAzB,CAAkC,CAChC,MAAO,KAAP,CACD,CAED,MACE,MAAA,CAAA,aAAA,CAAC,QAAD,CAAU,IAAV,CAAA,CACE,KAAK,CAAE,CACLwC,SAAS,CAAE,CAAC,CAAEC,UAAU,CAAE3C,GAAG,CAAC0B,CAAlB,CAAD,CADN,CAELkB,KAAK,CAAE,MAFF,CADT,CAKE,QAAQ,CAAGnB,kBAAAA,KAAD,CAAW,CACnB,GAAQoB,OAAAA,CAAWpB,KAAK,CAACqB,WAANrB,CAAkBsB,MAArC,CAAQF,MAAAA,CACR5C,WAAW,CAACY,OAAZZ,CAAsB4C,MAAtB5C,CACD,CARH,CASE,aAAa,CAAC,UAThB,CAAA,CAWE,KAAA,CAAA,aAAA,CAAC,OAAD,CAAA,QAAA,CAAA,CACE,QAAQ,CAAEH,QADZ,CAEE,WAAW,CAAEG,WAFf,CAGE,GAAG,CAAED,GAHP,CAIE,iBAAiB,CAAEH,iBAJrB,CAKE,WAAW,CAAEa,mBALf,CAME,GAAG,CAAEP,GANP,CAAA,CAOMD,KAPN,CAAA,CAXF,CADF,CAuBD,CA/CD,CAiDA,cAAed,KAAI,CAACC,UAAU,CAACkD,kBAAD,CAAX,CAAnB","sourcesContent":["import React, { memo, forwardRef } from 'react';\nimport { Modal } from '../../composites/Modal';\nimport type { IActionsheetContentProps } from './types';\nimport { usePropsResolution } from '../../../hooks';\nimport { Animated, PanResponder } from 'react-native';\nimport { ModalContext } from '../Modal/Context';\nimport Box from '../../primitives/Box';\nimport { ActionSheetContext } from './ActionSheetContext';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst Content = memo(\n  forwardRef(\n    (\n      {\n        hideDragIndicator,\n        children,\n        handleClose,\n        pan,\n        sheetHeight,\n        ...props\n      }: any,\n      ref: any\n    ) => {\n      const {\n        _dragIndicator,\n        _dragIndicatorWrapperOffSet,\n        _dragIndicatorWrapper,\n        ...resolvedProps\n      } = usePropsResolution('ActionsheetContent', props);\n\n      const handleCloseRef = React.useRef(null);\n      const handleCloseCallback = React.useCallback(() => {\n        let handleCloseCurrent = handleCloseRef.current;\n        //@ts-ignore\n        return handleCloseCurrent();\n      }, []);\n      React.useEffect(() => {\n        handleCloseRef.current = handleClose;\n      }, [handleClose]);\n\n      const panResponder = React.useRef(\n        PanResponder.create({\n          onStartShouldSetPanResponder: () => true,\n          onMoveShouldSetPanResponder: (_evt, gestureState) => {\n            return gestureState.dy > 15;\n          },\n          onPanResponderMove: (e, gestureState) => {\n            if (gestureState.dy > 0) {\n              Animated.event([null, { dy: pan.y }], {\n                useNativeDriver: false,\n              })(e, gestureState);\n            }\n          },\n          onPanResponderRelease: (_e, gestureState) => {\n            // If sheet is dragged 1/4th of it's height, close it\n            if (sheetHeight.current / 4 - gestureState.dy < 0) {\n              Animated.timing(pan, {\n                toValue: { x: 0, y: sheetHeight.current },\n                duration: 150,\n                useNativeDriver: true,\n              }).start(handleCloseCallback);\n\n              setTimeout(() => {\n                Animated.timing(pan, {\n                  toValue: { x: 0, y: 0 },\n                  duration: 150,\n                  useNativeDriver: true,\n                }).start();\n              }, 300);\n            } else {\n              Animated.spring(pan, {\n                toValue: { x: 0, y: 0 },\n                overshootClamping: true,\n                useNativeDriver: true,\n              }).start();\n            }\n          },\n        })\n      ).current;\n\n      return (\n        <>\n          {!hideDragIndicator ? (\n            <>\n              {/* To increase the draggable area */}\n              <Box\n                {...panResponder.panHandlers}\n                {..._dragIndicatorWrapperOffSet}\n              />\n            </>\n          ) : null}\n\n          <Modal.Content {...resolvedProps} ref={ref} safeAreaBottom>\n            {!hideDragIndicator ? (\n              <>\n                {/* Hack. Fix later. Add -2 negative margin to remove the padding added by ActionSheetContent */}\n                <Box {...panResponder.panHandlers} {..._dragIndicatorWrapper}>\n                  <Box {..._dragIndicator} />\n                </Box>\n              </>\n            ) : null}\n\n            {children}\n          </Modal.Content>\n        </>\n      );\n    }\n  )\n);\nconst ActionsheetContent = (\n  { children, ...props }: IActionsheetContentProps,\n  ref?: any\n) => {\n  // return null;\n  const { handleClose } = React.useContext(ModalContext);\n  const { hideDragIndicator } = React.useContext(ActionSheetContext);\n  const pan = React.useRef(new Animated.ValueXY()).current;\n  const sheetHeight = React.useRef(0);\n\n  const handleCloseCallback = React.useCallback(handleClose, [\n    ModalContext,\n    handleClose,\n  ]);\n\n  // useEffect(() => {\n\n  // }, [])\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  return (\n    <Animated.View\n      style={{\n        transform: [{ translateY: pan.y }],\n        width: '100%',\n      }}\n      onLayout={(event) => {\n        const { height } = event.nativeEvent.layout;\n        sheetHeight.current = height;\n      }}\n      pointerEvents=\"box-none\"\n    >\n      <Content\n        children={children}\n        sheetHeight={sheetHeight}\n        pan={pan}\n        hideDragIndicator={hideDragIndicator}\n        handleClose={handleCloseCallback}\n        ref={ref}\n        {...props}\n      />\n    </Animated.View>\n  );\n};\n\nexport default memo(forwardRef(ActionsheetContent));\n"]},"metadata":{},"sourceType":"module"}